<!DOCTYPE html>
<html lang="en">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<head>
  <title>Example_ND Phylogic Report</title>
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  <script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
  <script src="https://d3js.org/d3.v5.js"></script>
  <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.sample_name_table", {

        options: {
          columns: [],
          sample_names: [],
          sample_aliases: [],
          sample_dates: [],
          pie_plots: []
        },

        _elements: {
          table: undefined
        },

        _create: function() {
          let columns = this.options.columns;

          let table = d3.select(document.createElement("table"))
            .attr("class", "table table-bordered hover");

          let col_width = function (i) {
            switch (columns.length) {
              case 4:
                switch (i) {
                  case 0:
                    return "width:45%;";
                  case 1:
                    return "width:20%;";
                  case 2:
                    return "width:15%;";
                  case 3:
                    return "width:20%;";
                  default:
                    return "";
                }
              case 3:
                switch (i) {
                  case 0:
                    return "width:60%;";
                  case 1:
                    return "width:20%;";
                  case 2:
                    return "width:20%;";
                  default:
                    return "";
                }
              case 2:
                return i ? "width:20%;" : "width:80%;";
              default:
                return "";
            }
          };

          table.append("thead")
            .selectAll("td")
            .data(columns)
            .join("td")
            .attr("style", (_, i) => col_width(i) + " font-weight:bold; font-size: 12px")
            .html((_, i) => columns[i]);

          let row_elements = [];
          for (let i in this.options.sample_names) {
            let cols = 0;
            let row_str = d3.select(document.createElement("td"))
              .attr("style", col_width(cols) + " font-size: 12px")
              .html(this.options.sample_names[i])
              .node().outerHTML;
            cols++;
            if (this.options.sample_aliases.length) {
              row_str += d3.select(document.createElement("td"))
                .attr("style", col_width(cols) + " font-size: 12px")
                .html(this.options.sample_aliases[i])
                .node().outerHTML;
              cols++;
            }
            if (this.options.sample_dates.length) {
              row_str += d3.select(document.createElement("td"))
                .attr("style", col_width(cols) + " font-size: 12px")
                .html(this.options.sample_dates[i])
                .node().outerHTML;
              cols++;
            }
            if (this.options.pie_plots.length) {
              let td = d3.select(document.createElement("td"))
                .attr("style", col_width(cols));
              td.append("img")
                .attr("src", "data:image/png;base64," + this.options.pie_plots[i]);
              row_str += td.node().outerHTML;
            } else {
              row_str += d3.select(document.createElement("td"))
                .attr("style", col_width(cols))
                .html("Run BuildTree to display")
                .node().outerHTML;
            }
            row_elements.push(row_str);
          }

          table.append("tbody")
            .selectAll("tr")
            .data(row_elements)
            .join("tr")
            .html((_, i) => row_elements[i])
            .attr("style", "cursor: pointer;")
            .attr("class", "active-sample")
            .attr("onclick", "$(\"#sample-name-table\").sample_name_table(\"toggle_sample\", this)");

          this._elements.table = table.node();

          this._refresh()
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.table.outerHTML;
        },

        toggle_sample: function(row) {
          if (row.className === "active-sample") {
            row.className = "removed-sample";
          } else {
            row.className = "active-sample"
          }
        }

      });

      $("#sample-name-table").sample_name_table({"pie_plots": ["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"], "sample_names": ["sample_00", "sample_01", "sample_02", "sample_03"], "sample_dates": [0.0, 1.0, 2.0, 3.0], "columns": ["Sample Name", "Date", "Clonal Abundance"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.clustering_plot", {

        options: {
          xlabels: [],
          time_points: [],
          cluster_dict: {},
          width: 500,
          height: 400,
          margins: {top: 20, right: 50, bottom: 35, left: 50}
        },

        _elements: {
          time_points: undefined,
          time_scaled_plot: undefined,
          time_agnostic_plot: undefined,
          t: undefined,
          n: undefined,
          y: undefined,
          tooltip_t: undefined,
          tooltip_n: undefined,
          plot_top: undefined,
          plot_left: undefined,
          plot_1d: undefined
        },

        _create: function() {
          if (this.options.time_points.length > 0) {
            this._elements.time_points = this.options.time_points;
          } else {
            this._elements.time_points = [...Array(this.options.xlabels.length).keys()];
          }

          let real_time = false;
          for (let i in this._elements.time_points) {
            if (parseInt(i) !== this._elements.time_points[i]) {
              real_time = true;
              break;
            }
          }

          const xlabels = this.options.xlabels,
            time_points = this._elements.time_points,
            cluster_dict = this.options.cluster_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          if (xlabels.length > 1) {
            let t = d3.scaleLinear()
              .domain([Math.min(...time_points), Math.max(...time_points)])
              .range([margins.left, width - margins.right]);

            let n = d3.scaleLinear()
              .domain([0, xlabels.length - 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, 1])
              .range([height - margins.bottom, margins.top]);

            let xAxis_t = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(t));

            let xAxis_n = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(n).tickValues([...Array(xlabels.length).keys()]).tickFormat(d => xlabels[d]));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let line_t = d3.line()
              .x(d => t(d.t))
              .y(d => y(d.y));

            let line_n = d3.line()
              .x(d => n(d.n))
              .y(d => y(d.y));

            let time_scaled_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("overflow", "visible")
              .attr("onmousemove", "$(\"#clustering-plot\").clustering_plot(\"show_value\", event, this)")
              .attr("onmouseleave", "$(\"#clustering-plot\").clustering_plot(\"hide_value\")")
              .style("display", real_time ? "block" : "none")
              .style("max-height", "450px");
            time_scaled_plot.append("g")
              .call(xAxis_t);
            time_scaled_plot.append("g")
              .call(yAxis);
            time_scaled_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Time");
            time_scaled_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");

            let time_agnostic_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("overflow", "visible")
              .attr("onmousemove", "$(\"#clustering-plot\").clustering_plot(\"show_value\", event, this)")
              .attr("onmouseleave", "$(\"#clustering-plot\").clustering_plot(\"hide_value\")")
              .style("display", real_time ? "none" : "block")
              .style("max-height", "450px");
            time_agnostic_plot.append("g")
              .call(xAxis_n);
            time_agnostic_plot.append("g")
              .call(yAxis);
            time_agnostic_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Samples");
            time_agnostic_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");

            for (let cluster in cluster_dict) {
              let cluster_data_t = [];
              let cluster_data_n = [];
              let fill_data_t1 = "";
              let fill_data_t2 = "";
              let fill_data_n1 = "";
              let fill_data_n2 = "";

              for (let sample in cluster_dict[cluster].ccf_hat) {
                let r = cluster_dict[cluster].ccf_low.length - sample - 1;
                cluster_data_t.push({
                  t: time_points[sample],
                  y: cluster_dict[cluster].ccf_hat[sample]
                });
                cluster_data_n.push({
                  n: sample,
                  y: cluster_dict[cluster].ccf_hat[sample]
                });
                fill_data_t1 += t(time_points[sample]).toString() + "," + y(cluster_dict[cluster].ccf_high[sample]).toString() + " ";
                fill_data_t2 += t(time_points[r]).toString() + "," + y(cluster_dict[cluster].ccf_low[r]).toString() + " ";
                fill_data_n1 += n(sample).toString() + "," + y(cluster_dict[cluster].ccf_high[sample]).toString() + " ";
                fill_data_n2 += n(r).toString() + "," + y(cluster_dict[cluster].ccf_low[r]).toString() + " ";

                time_scaled_plot.append("circle")
                  .attr("fill", cluster_dict[cluster].color)
                  .attr("stroke", "none")
                  .attr("r", 7)
                  .attr("opacity", 1.0)
                  .attr("cx", t(time_points[sample]))
                  .attr("cy", y(cluster_dict[cluster].ccf_hat[sample]));

                time_agnostic_plot.append("circle")
                  .attr("fill", cluster_dict[cluster].color)
                  .attr("stroke", "none")
                  .attr("r", 7)
                  .attr("opacity", 1.0)
                  .attr("cx", n(sample))
                  .attr("cy", y(cluster_dict[cluster].ccf_hat[sample]));
              }

              time_scaled_plot.append("path")
                .datum(cluster_data_t)
                .attr("fill", "none")
                .attr("stroke", cluster_dict[cluster].color)
                .attr("stroke-width", cluster_dict[cluster].line_width)
                .attr("opacity", 0.5)
                .attr("d", line_t);

              time_agnostic_plot.append("path")
                .datum(cluster_data_n)
                .attr("fill", "none")
                .attr("stroke", cluster_dict[cluster].color)
                .attr("stroke-width", cluster_dict[cluster].line_width)
                .attr("opacity", 0.5)
                .attr("d", line_n);

              time_scaled_plot.append("polygon")
                .attr("points", fill_data_t1 + fill_data_t2)
                .attr("fill", cluster_dict[cluster].color)
                .attr("stroke", "none")
                .attr("opacity", 0.2);

              time_agnostic_plot.append("polygon")
                .attr("points", fill_data_n1 + fill_data_n2)
                .attr("fill", cluster_dict[cluster].color)
                .attr("stroke", "none")
                .attr("opacity", 0.2);
            }

            this._elements.time_scaled_plot = time_scaled_plot.node();
            this._elements.time_agnostic_plot = time_agnostic_plot.node();
            this._elements.t = t;
            this._elements.n = n;
            this._elements.y = y;
            this._elements.tooltip_t = time_scaled_plot.append("g")
              .attr("style", "display: none;");
            this._elements.tooltip_n = time_agnostic_plot.append("g")
              .attr("style", "display: none;");
          } else {
            let max_bin = 0,
              n_bins;
            for (let c in cluster_dict) {
              max_bin = Math.max(max_bin, ...cluster_dict[c].ccf_dist);
              n_bins = cluster_dict[c].ccf_dist.length
            }
            let x = d3.scaleLinear()
              .domain([0, 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, max_bin]).nice()
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let plot_1d = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
              .attr("style", "max-height: 450px");
            plot_1d.append("g")
              .call(xAxis);
            plot_1d.append("g")
              .call(yAxis);
            plot_1d.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            plot_1d.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Probability density");

            let zero_str = Array(n_bins).fill(0).reduce(
              (a, c, i) => a + " " + x((n_bins - i - 1) / (n_bins - 1)).toString() + "," + y(0).toString(), " "
            );

            plot_1d.selectAll("polygon")
              .data(Object.keys(cluster_dict))
              .join("polygon")
              .attr("points", d =>
                cluster_dict[d].ccf_dist.reduce(
                  (a, c, i) => a + " " + x(i / (n_bins - 1)).toString() + "," + y(c).toString(), ""
                ) + zero_str
              )
              .attr("fill", d => cluster_dict[d].color)
              .attr("opacity", 0.5)
              .attr("stroke", "none");

            this._elements.plot_1d = plot_1d.node()
          }

          this._refresh();
        },

        _refresh: function() {
          if (this.options.xlabels.length > 1) {
            this.element.context.innerHTML = this._elements.time_scaled_plot.outerHTML + this._elements.time_agnostic_plot.outerHTML;
          } else {
            this.element.context.innerHTML = this._elements.plot_1d.outerHTML;
          }
        },

        switch_plot: function() {
          if (this._elements.time_scaled_plot.style.display === "none") {
            this._elements.time_scaled_plot.style.display = "block";
            this._elements.time_agnostic_plot.style.display = "none";
          } else {
            this._elements.time_scaled_plot.style.display = "none";
            this._elements.time_agnostic_plot.style.display = "block";
          }

          this._refresh();
        },

        show_value: function(eve, plot) {
          let {width, height} = plot.getBoundingClientRect(),
            mouse_pos_x = eve.layerX * this.options.width / width,
            mouse_pos_y = eve.layerY * this.options.height / height,
            cluster_dict = this.options.cluster_dict;

          let tooltip,
            x,
            i,
            p;

          if (this._elements.time_scaled_plot.style.display === "none") {
            tooltip = this._elements.tooltip_n;
            let scale_x = this._elements.n;
            i = Math.round(scale_x.invert(mouse_pos_x));
            x = scale_x(i);
            p = "n";
          } else {
            tooltip = this._elements.tooltip_t;
            let scale_x = this._elements.t;
            let x_s = scale_x.invert(mouse_pos_x);
            let t = this._elements.time_points.reduce((a, c) => (Math.abs(c - x_s) < Math.abs(a - x_s) ? c : a));
            i = this._elements.time_points.indexOf(t);
            x = scale_x(t);
            p = "t";
          }

          let text = [this.options.xlabels[i]],
            active_clusters = [];
          for (let c in cluster_dict) {
            text.push(cluster_dict[c].ccf_hat[i].toString() + " (" + cluster_dict[c].ccf_low[i].toString() +
            "-" + cluster_dict[c].ccf_high[i].toString() + ")");
            active_clusters.push(parseInt(c));
          }

          tooltip
            .attr("style", "display: block;")
            .attr("transform", "translate(" + x.toString() + "," + mouse_pos_y.toString() + ")");

          let border = tooltip.selectAll("path")
            .data([null])
            .join("path")
              .attr("fill", "white")
              .attr("stroke", "black");

          let text_el = tooltip.selectAll("text")
            .data([null])
            .join("text")
            .attr("id", "tooltip-text_" + p)
            .attr("font-size", "9px")
            .call(t => t
              .selectAll("tspan")
              .data(text)
              .join("tspan")
                .attr("x", 0)
                .attr("y", (_, i) => (i * 1.1).toString() + "em")
                .style("font-weight", (_, i) => i ? null : "bold")
                .style("fill", (_, i) => i ? cluster_dict[active_clusters[i - 1]].color : "black")
                .text(d => d));

          this._refresh();

          let {y, width: w, height: h} = $("#tooltip-text_" + p)[0].getBBox();

          text_el.attr("transform", "translate(" + (-w / 2).toString() + "," + (15 - y).toString() + ")");
          border.attr("d", "M" + (-w / 2 - 10).toString() + ",5H-5l5,-5l5,5H" +
            (w / 2 + 10).toString() + "v" + (h + 20).toString() +
            "h-" + (w + 20).toString() + "z");

          this._refresh();
        },

        hide_value: function() {
          this._elements.tooltip_t.attr("style", "display: none;");
          this._elements.tooltip_n.attr("style", "display: none;");

          this._refresh();
        },

        download: function() {
          let dl_link;
          if (this.options.xlabels.length === 1) {
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.plot_1d.outerHTML);
          } else if (this._elements.time_scaled_plot.style.display === "none") {
            this.hide_value();
            let time_agnostic_plot = this._elements.time_agnostic_plot.cloneNode(true);
            time_agnostic_plot.removeAttribute("onmousemove");
            time_agnostic_plot.removeAttribute("onmouseleave");
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(time_agnostic_plot.outerHTML);
          } else {
            this.hide_value();
            let time_scaled_plot = this._elements.time_scaled_plot.cloneNode(true);
            time_scaled_plot.removeAttribute("onmousemove");
            time_scaled_plot.removeAttribute("onmouseleave");
            dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(time_scaled_plot.outerHTML);
          }
          let dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".clustering_plot.svg");
          dl.click();
        },

        _destroy: function() {
          this.element.context.innerHTML = "";
        }

      });

      $("#clustering-plot").clustering_plot({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [1.0, 1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"]}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"]}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"]}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"]}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"]}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"]}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"]}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"]}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"]}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"]}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"]}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"]}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"]}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"]}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"]}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"]}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"]}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"]}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"]}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"]}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"]}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"]}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"]}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"]}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"]}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"]}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"]}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"]}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"]}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"]}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"]}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"]}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"]}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"]}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"]}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"]}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"]}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"]}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"]}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"]}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"]}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"]}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"]}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.9403, 0.7211, 0.0096, 0.293], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"]}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"]}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"]}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"]}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"]}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"]}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"]}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"]}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"]}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"]}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"]}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"]}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"]}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"]}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"]}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"]}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"]}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"]}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"]}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"]}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.010700000000000001, 0.0901, 0.7984, 0.030299999999999997], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"]}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"]}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"]}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"]}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"]}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"]}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"]}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"]}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"]}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"]}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"]}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"]}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"]}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"]}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"]}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"]}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"]}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"]}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"]}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"]}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"]}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"]}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"]}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"]}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"]}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"]}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"]}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"]}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"]}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"]}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"]}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"]}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.013500000000000002, 0.0356, 0.1532, 0.6598], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"]}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"]}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"]}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"]}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"]}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"]}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"]}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"]}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"]}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"]}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"]}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"]}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"]}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"]}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"]}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"]}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"]}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"]}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"]}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"]}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"]}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"]}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"]}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"]}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"]}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"]}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"]}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"]}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"]}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"]}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"]}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"]}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"]}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"]}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"]}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"]}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"]}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"]}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"]}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"]}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"]}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"]}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"]}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"]}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"]}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"]}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"]}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"]}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"]}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"]}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"]}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"]}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"]}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"]}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"]}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"]}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"]}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"]}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"]}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"]}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"]}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"]}}, "line_width": 12}}, "xlabels": ["sample_00", "sample_01", "sample_02", "sample_03"], "time_points": [0.0, 1.0, 2.0, 3.0]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.time_switch", {

        options: {show: true},

        _elements: {time_switch: undefined, input: undefined},

        _create: function() {
          if (this.options.show) {
            let time_switch = d3.select(document.createElement("label"))
              .html("Time-scaled");
            this._elements.input = time_switch.append("input")
              .attr("type", "checkbox")
              .attr("checked", "")
              .attr("onclick", "$(\"#time-switch\").time_switch(\"switch_plot\")")
              .node();

            this._elements.time_switch = time_switch.node();

            this._refresh()

          }
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.time_switch.outerHTML;
        },

        is_checked: function() {
          if (this.options.show) {
            return this._elements.input.hasAttribute("checked")
          }
          return true
        },

        switch_plot: function() {
          if (this.is_checked()) {
            this._elements.input.removeAttribute("checked");
          } else {
            this._elements.input.setAttribute("checked", "");
          }
          $("#clustering-plot").clustering_plot("switch_plot");

          this._refresh();
        }

      });

      $("#time-switch").time_switch({"show": false})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.cluster_switches", {
        options: {
          cluster_dict: {},
          time_points: [],
          xlabels: []
        },

        _elements: {
          active_clusters: [],
          svg_switches: undefined
        },

        _create: function() {
          let cluster_dict = this.options.cluster_dict,
            svg_layout = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
          for (let c in cluster_dict) {
            this._elements.active_clusters.push(c);
          }
          svg_layout.attr("viewBox", "0 0 120 " + ((this._elements.active_clusters.length + 2) * 30));
          svg_layout.selectAll("rect")
            .data(this._elements.active_clusters)
            .join("rect")
            .attr("class", "active-cluster")
            .attr("style", "cursor: pointer;")
            .attr("cluster", (_, i) => i + 1)
            .attr("x", 0)
            .attr("y", (_, i) => i * 30 + 30)
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", d => cluster_dict[d].color)
            .attr("stroke", "none")
            .attr("opacity", 0.8)
            .attr("onclick", "$(\"#cluster-switches\").cluster_switches(\"toggle_cluster\", this)");
          svg_layout.selectAll("text")
            .data(this._elements.active_clusters)
            .join("text")
            .attr("x", 30)
            .attr("y", (_, i) => i * 30 + 45)
            .attr("fill", d => cluster_dict[d].color)
            .text(d => d + " (" + Object.keys(cluster_dict[d].muts).length.toString() + ")");
          svg_layout.append("text")
            .attr("x", 0)
            .attr("y", 15)
            .attr("font-size", "11.5px")
            .text("Cluster (# variants)");

          this._elements.svg_switches = svg_layout.node();

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.svg_switches.outerHTML;
        },

        toggle_cluster: function(cluster_switch) {
          let c = cluster_switch.getAttribute("cluster"),
            cluster_dict = this.options.cluster_dict,
            active_clusters = this._elements.active_clusters,
            cluster_dict_subset = {};
          if (cluster_switch.getAttribute("class") === "active-cluster") {
            cluster_switch.setAttribute("class", "removed-cluster");
            cluster_switch.setAttribute("opacity", 0.2);
            for (let i in active_clusters) {
              if (active_clusters[i] === c) {
                active_clusters.splice(i, 1);
                break;
              }
            }
          } else {
            cluster_switch.setAttribute("class", "active-cluster");
            cluster_switch.setAttribute("opacity", 1.0);
            active_clusters.push(c);
          }
          for (let i in active_clusters) {
            let active_cluster = active_clusters[i];
            cluster_dict_subset[active_cluster] = cluster_dict[active_cluster];
          }
          let clustering_plot = $("#clustering-plot");
          clustering_plot.clustering_plot("destroy");
          clustering_plot.clustering_plot({
            xlabels: this.options.xlabels,
            time_points: this.options.time_points,
            cluster_dict: cluster_dict_subset});
          if (!$("#time-switch").time_switch("is_checked")) {
            clustering_plot.clustering_plot("switch_plot");
          }
        }
      });

      $("#cluster-switches").cluster_switches({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [1.0, 1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"]}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"]}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"]}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"]}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"]}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"]}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"]}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"]}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"]}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"]}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"]}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"]}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"]}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"]}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"]}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"]}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"]}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"]}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"]}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"]}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"]}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"]}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"]}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"]}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"]}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"]}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"]}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"]}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"]}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"]}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"]}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"]}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"]}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"]}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"]}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"]}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"]}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"]}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"]}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"]}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"]}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"]}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"]}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.9403, 0.7211, 0.0096, 0.293], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"]}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"]}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"]}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"]}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"]}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"]}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"]}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"]}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"]}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"]}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"]}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"]}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"]}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"]}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"]}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"]}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"]}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"]}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"]}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"]}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.010700000000000001, 0.0901, 0.7984, 0.030299999999999997], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"]}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"]}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"]}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"]}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"]}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"]}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"]}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"]}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"]}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"]}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"]}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"]}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"]}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"]}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"]}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"]}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"]}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"]}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"]}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"]}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"]}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"]}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"]}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"]}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"]}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"]}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"]}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"]}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"]}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"]}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"]}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"]}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.013500000000000002, 0.0356, 0.1532, 0.6598], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"]}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"]}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"]}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"]}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"]}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"]}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"]}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"]}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"]}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"]}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"]}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"]}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"]}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"]}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"]}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"]}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"]}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"]}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"]}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"]}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"]}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"]}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"]}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"]}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"]}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"]}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"]}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"]}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"]}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"]}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"]}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"]}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"]}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"]}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"]}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"]}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"]}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"]}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"]}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"]}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"]}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"]}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"]}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"]}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"]}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"]}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"]}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"]}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"]}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"]}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"]}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"]}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"]}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"]}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"]}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"]}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"]}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"]}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"]}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"]}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"]}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"]}}, "line_width": 12}}, "xlabels": ["sample_00", "sample_01", "sample_02", "sample_03"], "time_points": [0.0, 1.0, 2.0, 3.0]})
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.tree", {

        options: {
          patient: "",
          child_dict: {},
          dist_from_parent: {},
          cluster_dict: {}
        },

        _elements: {
          svg_tree: undefined,
          tooltip: undefined
        },

        _create: function() {
          const patient = this.options.patient,
            child_dict = this.options.child_dict,
            dist_from_parent = this.options.dist_from_parent,
            cluster_dict = this.options.cluster_dict;

          let angles = [];
          for (let i in [...Array(72)]) {
            angles.push(Math.PI * i / 72);
          }

          let svg_tree = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "visible")
            .attr("style", "max-height: 520px;")
            .attr("width", this.element.context.parentNode.getBoundingClientRect().width);

          svg_tree.append("g")
            .append("text")
              .attr("x", -20)
              .attr("y", 40)
              .attr("text-anchor", "end")
              .attr("font", "Arial")
              .attr("font-size", "20px")
              .html(patient);

          let branch_cont = svg_tree.append("g"),
            node_cont = svg_tree.append("g"),
            node_label_cont = svg_tree.append("g"),
            branch_label_cont = svg_tree.append("g");

          let x_start = 0,
            y_start = 0,
            x_end = 0,
            y_end = 0,
            x_min = 0,
            y_min = 0,
            x_max = 0,
            y_max = 0;
          node_cont.append("ellipse")
            .attr("cx", x_start)
            .attr("cy", y_start)
            .attr("rx", 24)
            .attr("ry", 24)
            .attr("stroke", "white")
            .attr("fill", "blue")
            .attr("stroke-width", 0)
            .attr("opacity", 1.0);
          node_label_cont.append("text")
            .attr("font", "Arial")
            .attr("font-size", "14px")
            .attr("x", 0)
            .attr("y", 4)
            .attr("text-anchor", "middle")
            .attr("fill", "white")
            .html("normal");

          let next_clusters = child_dict[null],
            i = 0,
            existing_nodes = {null: [0, 0]},
            existing_edges = [],
            parents = {};
          for (let child in next_clusters) {
            parents[next_clusters[child]] = null;
          }

          while (i < next_clusters.length) {
            let c = next_clusters[i];
            for (let child in child_dict[c]) {
              parents[child_dict[c][child]] = c;
            }
            let edge_len = Math.min(200, Math.max(30, 400 * dist_from_parent[c])),
              angle_tilt = 0;
            if (i === 0) {
              angle_tilt = Math.PI / 2;
              x_end = x_start + edge_len * Math.cos(angle_tilt);
              y_end = y_start + edge_len * Math.sin(angle_tilt);
            } else {
              [x_start, y_start] = existing_nodes[parents[c]];
              let min_intersects_an_edge = true,
                max_closest_edge_distance_sq = 0,
                max_closest_neighbor_sq = 0;
              for (let a in angles) {
                let ang = angles[a],
                  x0 = x_start + edge_len * Math.cos(ang),
                  y0 = y_start + edge_len * Math.sin(ang);
                let intersects_an_edge = false,
                  closest_edge_distance_sq = Infinity,
                  closest_neighbor_sq = Infinity;
                for (let edge_idx in existing_edges) {
                  let edge = existing_edges[edge_idx],
                    a = x0 - edge[0],
                    b = y0 - edge[1],
                    c = edge[2] - edge[0],
                    d = edge[3] - edge[1],
                    p = (a * c + b * d) / (c * c + d * d),
                    xx,
                    yy,
                    cp1 = c * (y_start - edge[3]) - d * (x_start - edge[2]),
                    cp2 = c * (y0 - edge[3]) - d * (x0 - edge[2]),
                    cp3 = (x0 - x_start) * (edge[1] - y0) - (y0 - y_start) * (edge[0] - x0),
                    cp4 = (x0 - x_start) * (edge[3] - y0) - (y0 - y_start) * (edge[2] - x0);
                  if (p < 0 || (c === 0 && d === 0)) {
                    xx = edge[0];
                    yy = edge[1];
                  } else if (p > 1) {
                    xx = edge[2];
                    yy = edge[3];
                  } else {
                    xx = edge[0] + p * c;
                    yy = edge[1] + p * d;
                  }
                  let edge_dist_sq = (x0 - xx) * (x0 - xx) + (y0 - yy) * (y0 - yy);
                  closest_edge_distance_sq = edge_dist_sq < closest_edge_distance_sq ? edge_dist_sq : closest_edge_distance_sq;
                  intersects_an_edge = (cp1 * cp2 < 0) && (cp3 * cp4 < 0) ? true : intersects_an_edge;
                }
                for (let node_idx in existing_nodes) {
                  let node = existing_nodes[node_idx],
                    node_dist_sq = (x0 - node[0]) * (x0 - node[0]) + (y0 - node[1]) * (y0 - node[1]);
                  closest_neighbor_sq = node_dist_sq < closest_neighbor_sq ? node_dist_sq : closest_neighbor_sq;
                }
                if (~intersects_an_edge && min_intersects_an_edge) {
                  min_intersects_an_edge = false;
                  max_closest_edge_distance_sq = closest_edge_distance_sq;
                  max_closest_neighbor_sq = closest_neighbor_sq;
                  angle_tilt = ang;
                  x_end = x0;
                  y_end = y0;
                } else if ((~intersects_an_edge && ~min_intersects_an_edge) || (intersects_an_edge && min_intersects_an_edge)) {
                  if (closest_edge_distance_sq > max_closest_edge_distance_sq) {
                    max_closest_edge_distance_sq = closest_edge_distance_sq;
                    max_closest_neighbor_sq = closest_neighbor_sq;
                    angle_tilt = ang;
                    x_end = x0;
                    y_end = y0;
                  } else if ((closest_edge_distance_sq === max_closest_edge_distance_sq) && (closest_neighbor_sq > max_closest_neighbor_sq)) {
                    max_closest_neighbor_sq = closest_neighbor_sq;
                    angle_tilt = ang;
                    x_end = x0;
                    y_end = y0;
                  }
                }
              }
            }

            node_cont.append("ellipse")
              .attr("cx", x_end)
              .attr("cy", y_end)
              .attr("rx", 12)
              .attr("ry", 12)
              .attr("stroke", "white")
              .attr("stroke-width", 1)
              .attr("fill", cluster_dict[c].color)
              .attr("opacity", 1.0);

            branch_cont.append("line")
              .attr("x1", x_start)
              .attr("y1", y_start)
              .attr("x2", x_end)
              .attr("y2", y_end)
              .attr("stroke", cluster_dict[c].color)
              .attr("stroke-width", 15)
              .attr("opacity", 1.0)
              .attr("class", c);

            node_label_cont.append("text")
              .attr("font", "Arial")
              .attr("font-size", "14px")
              .attr("x", x_end)
              .attr("y", y_end + 4)
              .attr("text-anchor", "middle")
              .attr("fill", "white")
              .html(c.toString());

            branch_label_cont.append("text")
              .attr("font", "Arial")
              .attr("font-size", "10px")
              .attr("y", ((y_start + y_end) / 2) - (5 * cluster_dict[c].drivers.length + 5))
              .attr("text-anchor", "middle")
              .attr("font-weight", "bold")
              .selectAll("tspan")
              .data(["(" + Object.keys(cluster_dict[c].muts).length.toString() + ")", ...cluster_dict[c].drivers])
              .join("tspan")
                .attr("x", (x_start + x_end) / 2)
                .attr("dy", 10)
                .text(d => d);

            existing_nodes[c] = [x_end, y_end];
            existing_edges.push([x_start, y_start, x_end, y_end]);
            next_clusters.push(...child_dict[c]);
            i += 1;
            x_min = x_end < x_min ? x_end : x_min;
            y_min = y_end < y_min ? y_end : y_min;
            x_max = x_end > x_max ? x_end : x_max;
            y_max = y_end > y_max ? y_end : y_max;

          }

          svg_tree.attr("viewBox", (x_min - 50).toString() + "," + (y_min - 50).toString() + "," + (x_max - x_min + 100).toString() + "," + (y_max - y_min + 100).toString());

          this._elements.tooltip = svg_tree.append("g")
            .attr("style", "display: none;")
            .node();

          this._elements.svg_tree = svg_tree.node();

          this._refresh();

          d3.select(this.element.context.parentElement).append("button")
            .attr("onclick", "$(\"#tree\").tree(\"download\")")
            .attr("style", "font-size: 12px;")
            .html("Download as SVG")
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.svg_tree.outerHTML;
        },

        toggle_mutations: function(eve) {
          if (typeof eve.target.getAttribute("class") === "string") {
            let branch = eve.target,
              tooltip = d3.select(this._elements.tooltip),
              cluster_dict = this.options.cluster_dict,
              x0 = (parseFloat(branch.getAttribute("x1")) + parseFloat(branch.getAttribute("x2"))) / 2,
              y0 = (parseFloat(branch.getAttribute("y1")) + parseFloat(branch.getAttribute("y2"))) / 2;
            tooltip.attr("style", "display: block;")
              .attr("transform", "translate(" + x0.toString() + "," + y0.toString() + ")");

            let border = tooltip.selectAll("path")
              .data([null])
              .join("path")
                .attr("fill", "white")
                .attr("stroke", "black");

            tooltip.selectAll("text")
              .data([null])
              .join("text")
              .attr("id", "diff-muts")
              .attr("text-anchor", "middle")
              .call(t => t
                .selectAll("tspan")
                .data(Object.keys(cluster_dict[branch.getAttribute("class")].muts))
                .join("tspan")
                .attr("x", 0)
                .attr("dy", 10)
                .attr("font-size", "9px")
                .text(d => d));

            this._refresh();

            let {width: w, height: h} = $("#diff-muts")[0].getBBox();

            border.attr("d", "M" + (-w / 2 - 10).toString() + ",-5H-5l5,-5l5,5H" +
              (w / 2 + 10).toString() + "v" + (h + 15).toString() +
              "h-" + (w + 20).toString() + "z");

            this._refresh();
          } else if (eve.target.nodeName === "svg") {
            d3.select(this._elements.tooltip).attr("style", "display: none;");

            this._refresh();
          }
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.svg_tree.outerHTML.replace("viewbox", "viewBox")),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".tree.svg");
          dl.click();
        }

      });

      let tree_options = {"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [1.0, 1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"]}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"]}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"]}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"]}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"]}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"]}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"]}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"]}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"]}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"]}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"]}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"]}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"]}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"]}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"]}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"]}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"]}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"]}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"]}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"]}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"]}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"]}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"]}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"]}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"]}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"]}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"]}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"]}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"]}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"]}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"]}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"]}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"]}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"]}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"]}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"]}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"]}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"]}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"]}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"]}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"]}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"]}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"]}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.9403, 0.7211, 0.0096, 0.293], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"]}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"]}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"]}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"]}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"]}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"]}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"]}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"]}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"]}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"]}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"]}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"]}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"]}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"]}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"]}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"]}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"]}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"]}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"]}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"]}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.010700000000000001, 0.0901, 0.7984, 0.030299999999999997], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"]}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"]}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"]}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"]}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"]}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"]}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"]}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"]}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"]}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"]}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"]}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"]}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"]}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"]}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"]}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"]}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"]}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"]}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"]}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"]}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"]}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"]}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"]}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"]}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"]}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"]}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"]}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"]}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"]}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"]}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"]}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"]}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.013500000000000002, 0.0356, 0.1532, 0.6598], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"]}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"]}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"]}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"]}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"]}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"]}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"]}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"]}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"]}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"]}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"]}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"]}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"]}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"]}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"]}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"]}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"]}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"]}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"]}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"]}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"]}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"]}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"]}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"]}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"]}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"]}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"]}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"]}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"]}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"]}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"]}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"]}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"]}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"]}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"]}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"]}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"]}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"]}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"]}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"]}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"]}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"]}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"]}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"]}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"]}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"]}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"]}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"]}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"]}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"]}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"]}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"]}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"]}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"]}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"]}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"]}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"]}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"]}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"]}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"]}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"]}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"]}}, "line_width": 12}}, "dist_from_parent": {"1": 1.0, "2": 0.31746031746031744, "3": 0.4266666666666667, "4": 0.5904761904761905}, "child_dict": {"1": [2, 3, 4], "null": [1], "3": [], "4": [], "2": []}, "patient": "Example_ND"};

      if (tree_options) {
        $("#tree").tree(tree_options)
      } else {
        $("#tree").append("h3")
          .html("Run BuildTree to display tree")
      }

    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.treatment_plot", {

        options: {
          width: 500,
          height: 50,
          margins: {right: 50, left: 50},
          treatments: [],
          samples: [],
          treatment_color_map: {}
        },

        _elements: {
          treatment_plot: undefined,
          tooltip: undefined
        },

        _create: function() {
          const width = this.options.width,
            height = this.options.height,
            margins = this.options.margins,
            treatments = this.options.treatments,
            samples = this.options.samples,
            treatment_color_map = this.options.treatment_color_map;

          let t = d3.scaleLinear()
            .domain([Math.min(...samples), Math.max(...samples)])
            .range([margins.left, width - margins.right]);

          let xAxis = g => g
            .attr("transform", "translate(0 " + height.toString() + ")")
            .call(d3.axisBottom(t));

          let treatment_plot = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("viewBox", "0 0 " + width + " " + (height * 2))
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "visible")
            .attr("onclick", "$(\"#treatment-plot\").treatment_plot(\"toggle_tx\", event)")
            .style("max-height", "100px");
          treatment_plot.append("g")
            .call(xAxis);

          for (let tx in treatments) {
            let tx_start = Math.max(treatments[tx].tx_start, samples[0]),
              tx_end = Math.min(treatments[tx].tx_end, samples[samples.length - 1]);
            if (tx_end > samples[0] && tx_start < samples[samples.length - 1]) {
              let color = treatment_color_map[treatments[tx].tx];
              treatment_plot.append("line")
                .attr("stroke", color)
                .attr("stroke-width", 10)
                .attr("x1", t(tx_start))
                .attr("x2", t(tx_end))
                .attr("y1", 25)
                .attr("y2", 25)
                .attr("opacity", 1.0)
                .attr("tx", treatments[tx].tx)
                .attr("style", "cursor: pointer;")
            }
          }

          for (let s in samples) {
            treatment_plot.append("line")
              .attr("stroke", "black")
              .attr("stroke-width", 1)
              .attr("x1", t(samples[s]))
              .attr("x2", t(samples[s]))
              .attr("y1", 10)
              .attr("y2", 40)
              .attr("opacity", 1.0);
          }

          this._elements.tooltip = treatment_plot.append("g")
            .attr("style", "display: none;")
            .node();
          this._elements.treatment_plot = treatment_plot.node();

          this._refresh()
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.treatment_plot.outerHTML
        },

        toggle_tx: function(eve) {
          if (typeof eve.target.getAttribute("tx") === "string") {
            let tx_line = eve.target,
              tooltip = d3.select(this._elements.tooltip);
            let {x, width} = tx_line.getBBox(),
              tx_mid = x + (width / 2);
            tooltip.attr("style", "display: block;")
              .attr("transform", "translate(" + tx_mid.toString() + ",60)");

            let border = tooltip.selectAll("path")
              .data([null])
              .join("path")
                .attr("fill", "white")
                .attr("stroke", "black");

            tooltip.selectAll("text")
              .data([null])
              .join("text")
              .attr("id", "treatment-text")
              .attr("text-anchor", "middle")
              .call(t => t
                .selectAll("tspan")
                .data([tx_line.getAttribute("tx")])
                .join("tspan")
                .attr("x", 0)
                .attr("y", 0)
                .text(d => d));

            this._refresh();

            let {width: w, height: h} = $("#treatment-text")[0].getBBox();

            border.attr("d", "M" + (-w / 2 - 10).toString() + " " + (-h / 2 - 15).toString() + " H " +
              (w / 2 + 10).toString() + " V " + (h / 2 + 5).toString() + " H " + (-w / 2 - 10).toString() + " Z");
          } else {
            this._elements.tooltip.setAttribute("style", "display: none;");
          }

          this._refresh();
        }

      });

      let treatment_data = {"treatment_color_map": {"tx3": "rgb(152,22,26)", "tx2": "rgb(93,119,254)", "tx1": "rgb(16,49,41)"}, "treatments": [{"tx_start": 0.0, "tx_end": 1.0, "tx": "tx1"}, {"tx_start": 1.0, "tx_end": 1.5, "tx": "tx2"}, {"tx_start": 2.0, "tx_end": 3.0, "tx": "tx3"}], "samples": [0.0, 1.0, 2.0, 3.0]};

      if (treatment_data) {
        $("#treatment-plot").treatment_plot(treatment_data);
      }

    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.mutation_visual", {
        options: {
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], color: "green", muts: {}, drivers: []}},
          aliases: []
        },

        _elements: {
          mutation_visual: undefined
        },

        _create: function() {
          const cluster_dict = this.options.cluster_dict,
            aliases = this.options.aliases;
          let svg_visual = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink")
            .attr("overflow", "auto"),
            c_groups = [[], [], [], []],
            group_names = ["UNIVERSAL MUTATIONS", "OTHER COMMON MUTATIONS", "OTHER CLONAL", "SUBCLONAL"],
            group_min_lens = [200, 200, 150, 150];
          for (let c in cluster_dict) {
            let clonality = [];
            for (let s in cluster_dict[c].ccf_hat) {
              let cl = cluster_dict[c].ccf_hat[s];
              if (cl > 0.9) {
                clonality.push(1);
              } else if (cl > 0.1) {
                clonality.push(0.5);
              } else {
                clonality.push(0);
              }
            }
            if (clonality.every(v => v === 1)) {
              c_groups[0].push(c);
            } else if (clonality.reduce((p, a) => p + a) > 1) {
              c_groups[1].push(c);
            } else if (clonality.some(v => v === 1)) {
              c_groups[2].push(c);
            } else {
              c_groups[3].push(c);
            }
          }

          for (let a in aliases) {
            svg_visual.append("g")
              .attr("transform", "translate(15," + (a * 12 + 133).toString() + ")")
              .append("svg")
                .attr("width", "100px")
                .attr("height", "20px")
                .attr("x", 10)
                .attr("y", 10)
                .attr("stroke-width", 1)
                .attr("stroke", "black")
                .append("text")
                  .html(aliases[a])
                  .attr("font-size", "9px")
                  .attr("x", 10)
                  .attr("y", 10)
                  .attr("text-anchor", "start")
                  .attr("textLength", 50)
                  .attr("class", "samples");
          }

          let x_offset = 20,
            y_offset = 30,
            header_x_offset = 70;

          for (let g in c_groups) {
            if (c_groups[g].length) {
              let g_len = 0;
              for (let i in c_groups[g]) {
                let c = c_groups[g][i],
                  box_stroke = cluster_dict[c].color,
                  drivers = cluster_dict[c].drivers,
                  muts = cluster_dict[c].muts,
                  sorted_muts = Object.keys(muts).sort(function(a, b) {
                    if (drivers.includes(a) && drivers.includes(b)) {
                      return 0
                    }
                    if (drivers.includes(a)) {
                      return -1
                    }
                    if (drivers.includes(b)) {
                      return 1
                    }
                    return 0
                  });
                g_len += sorted_muts.length * 12;
                for (let ii in sorted_muts) {
                  let mut = sorted_muts[ii],
                    mut_group = svg_visual.append("g")
                    .attr("class", "mut_group"),
                    mut_suffix = mut.includes("_") ? mut.split("_")[1] : "p.A0A",
                    text_color = (mut_suffix.length > 3 && mut_suffix[2] === mut_suffix[mut_suffix.length - 1]) ? "gray" : "black",
                    text_weight = drivers.includes(mut) ? "bold" : "normal";
                  mut_group.append("g")
                    .attr("transform", "rotate(-75," + (x_offset + 53).toString() + ",145) " +
                      "translate(" + (x_offset + 53).toString() + ",145)")
                    .append("svg")
                      .attr("width", "100px")
                      .attr("height", "20px")
                      .attr("x", 10)
                      .attr("y", 10)
                      .append("text")
                        .html(mut)
                        .attr("font-size", "9px")
                        .attr("font-family", "Arial")
                        .attr("fill", text_color)
                        .attr("x", 10)
                        .attr("y", 10)
                        .attr("text-anchor", "start")
                        .attr("textLength", 70)
                        .attr("font-weight", text_weight)
                        .attr("class", "cluster_" + c.toString());
                  for (let a in aliases) {
                    let ccf_hat = cluster_dict[c].ccf_hat[a],
                      ccf_1d = muts[mut].ccf_hat[a],
                      box_color = ccf_1d < 0.1 ? "white" : cluster_dict[c].color,
                      box_size = ccf_hat * 9 + 1,
                      a_box_stroke = ccf_hat > 0.9 ? "red" : box_stroke;
                    mut_group.append("rect")
                      .attr("x", x_offset + 75 - (box_size / 2.0))
                      .attr("y", y_offset + 120 + (a * 12) - (box_size / 2.0))
                      .attr("width", box_size.toString() + "px")
                      .attr("height", box_size.toString() + "px")
                      .attr("stroke-width", 1)
                      .attr("stroke", a_box_stroke)
                      .attr("fill", box_color)
                      .attr("opacity", 0.8)
                      .attr("class", "cluster_" + c.toString());
                  }
                  x_offset += 12;
                }
              }
              svg_visual.append("g")
                .attr("transform", "translate(" + (20 + header_x_offset).toString() + ",30)")
                .append("svg")
                  .attr("width", g_len)
                  .attr("height", "20px")
                  .attr("x", 10)
                  .attr("y", 10)
                  .attr("stroke-width", 1)
                  .attr("stroke", "black")
                  .append("text")
                    .html(group_names[g])
                    .attr("font-size", g_len > group_min_lens[g] ? "12px" : "8px")
                    .attr("x", 10)
                    .attr("y", 10)
                    .attr("text-anchor", "start");
              header_x_offset += g_len + 8;
              x_offset += 10;
            }
          }
          svg_visual
            .attr("width", x_offset + 110)
            .attr("height", y_offset + 160 + (aliases.length * 12));
          this._elements.mutation_visual = svg_visual.node();

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.mutation_visual.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.mutation_visual.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".clonality_chart.svg");
          dl.click();
        }
      });

      $("#mutation-visual").mutation_visual({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [1.0, 1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"]}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"]}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"]}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"]}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"]}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"]}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"]}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"]}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"]}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"]}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"]}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"]}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"]}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"]}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"]}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"]}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"]}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"]}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"]}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"]}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"]}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"]}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"]}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"]}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"]}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"]}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"]}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"]}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"]}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"]}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"]}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"]}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"]}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"]}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"]}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"]}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"]}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"]}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"]}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"]}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"]}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"]}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"]}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.9403, 0.7211, 0.0096, 0.293], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"]}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"]}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"]}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"]}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"]}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"]}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"]}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"]}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"]}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"]}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"]}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"]}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"]}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"]}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"]}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"]}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"]}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"]}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"]}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"]}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.010700000000000001, 0.0901, 0.7984, 0.030299999999999997], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"]}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"]}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"]}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"]}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"]}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"]}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"]}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"]}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"]}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"]}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"]}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"]}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"]}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"]}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"]}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"]}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"]}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"]}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"]}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"]}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"]}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"]}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"]}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"]}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"]}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"]}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"]}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"]}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"]}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"]}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"]}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"]}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.013500000000000002, 0.0356, 0.1532, 0.6598], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"]}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"]}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"]}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"]}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"]}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"]}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"]}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"]}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"]}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"]}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"]}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"]}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"]}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"]}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"]}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"]}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"]}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"]}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"]}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"]}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"]}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"]}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"]}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"]}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"]}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"]}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"]}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"]}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"]}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"]}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"]}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"]}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"]}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"]}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"]}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"]}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"]}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"]}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"]}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"]}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"]}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"]}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"]}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"]}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"]}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"]}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"]}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"]}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"]}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"]}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"]}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"]}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"]}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"]}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"]}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"]}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"]}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"]}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"]}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"]}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"]}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"]}}, "line_width": 12}}, "aliases": ["sample_00", "sample_01", "sample_02", "sample_03"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.cluster_table", {

        options: {
          aliases: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], color: "green", muts: {}}},
        },

        _elements: {
          cluster_table: undefined,
          column_data: undefined,
          table_data: undefined,
          cluster_datatable: undefined
        },

        _create: function() {
          let aliases = this.options.aliases,
            cluster_dict = this.options.cluster_dict,
            table_el = d3.select(document.createElement("table"))
              .attr("id", "cluster_table")
              .attr("class", "hover"),
            col_width = Math.round(100 / (aliases.length + 1.3)),
            cluster_col_width = 100 - (aliases.length * col_width),
            columns = [{"data": "Cluster", "width": cluster_col_width.toString() + "%"}],
            col_list = ["Cluster"];
          for (let i in aliases) {
            columns.push({"data": aliases[i] + " CCF", "width": col_width.toString() + "%"});
            col_list.push(aliases[i] + " CCF");
          }
          table_el.append("thead")
            .selectAll("th")
            .data(col_list)
            .join("th")
            .text(d => d);
          let cluster_data = [];
          for (let c in cluster_dict) {
            let cluster_dat = {"Cluster": c};
            for (let i in aliases) {
              cluster_dat[aliases[i] + " CCF"] = cluster_dict[c].ccf_hat[i] + " (" + cluster_dict[c].ccf_low[i] + "-" + cluster_dict[c].ccf_high[i] + ")";
            }
            cluster_data.push(cluster_dat);
          }
          this._elements.cluster_table = table_el.node();
          this._elements.column_data = columns;
          this._elements.table_data = {"columns": columns,
            "data": cluster_data,
            "order": [[0, "asc"]],
            "paging": false,
            "bInfo": false,
            "createdRow": function(row, data, dataIndex) {
              $(row).css("color", cluster_dict[dataIndex + 1].color)
                .css("cursor", "pointer")
                .attr("id", "mutation_row_cluster " + (dataIndex + 1).toString())
            }};

          this._refresh();
        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.cluster_table.outerHTML;
          this._elements.cluster_datatable = $("#cluster_table").DataTable(this._elements.table_data);
          $("#cluster_table tbody").on("click", "tr", this.toggle_mutations(this));
          let search_input = $(".dataTables_filter input");
          search_input.unbind().bind("keyup", function(e) {
            if (search_input.val().length === 0) {
              for (let c in this.options.cluster_dict) {
                this.hide_mutations(c);
              }
            } else if (e.keyCode === 13) {
              for (let c in this.options.cluster_dict) {
                let cluster_table = this.show_mutations(c);
                cluster_table.search(search_input.val()).draw();
                if (cluster_table.page.info().recordsDisplay === 0) {
                  this.hide_mutations(c);
                }
              }
            }
          }
          .bind(this));
        },

        toggle_mutations: function(widg) {
          return function() {
            let row = widg._elements.cluster_datatable.row($(this));
            if (row.data()) {
              if (row.child.isShown()) {
                row.child.hide();
              } else {
                let c = row.data().Cluster,
                  cluster_muts = widg.options.cluster_dict[c].muts,
                  drivers = widg.options.cluster_dict[c].drivers,
                  color = widg.options.cluster_dict[c].color,
                  aliases = widg.options.aliases,
                  mut_data = [];
                for (let mut in cluster_muts) {
                  let mut_dat = {"is_driver": drivers.includes(mut) ? 0 : 1, "Cluster": mut};
                  for (let i in aliases) {
                    mut_dat[aliases[i] + " CCF"] = cluster_muts[mut].ccf_hat[i] + " (" + cluster_muts[mut].alt_cnt[i] + ":" + cluster_muts[mut].ref_cnt[i] + ")";
                  }
                  mut_data.push(mut_dat);
                }
                row.child("<table id=\"cluster_" + row.data().Cluster + "_table\" class=\"hover\"></table>").show();
                cluster_table = $("#cluster_" + row.data().Cluster + "_table").DataTable({
                  "columns": [{"data": "is_driver", "visible": false}].concat(widg._elements.column_data),
                  "data": mut_data,
                  "autoWidth": false,
                  "order": [[0, "asc"]],
                  "paging": false,
                  "scrollY": 320,
                  "scrollCollapse": true,
                  "createdRow": function(row, data) {
                    $(row).css("color", color);
                    if (data.is_driver === 0) {
                      $(row).css("font-weight", "bold");
                    }
                  }
                });
              }
            }
          }
        },

        show_mutations: function(cluster) {
          let row = this._elements.cluster_datatable.row(cluster - 1),
            cluster_table;
          if (~row.child.isShown()) {
            let cluster_muts = this.options.cluster_dict[cluster].muts,
              drivers = this.options.cluster_dict[cluster].drivers,
              color = this.options.cluster_dict[cluster].color,
              aliases = this.options.aliases,
              mut_data = [];
            for (let mut in cluster_muts) {
              let mut_dat = {"is_driver": drivers.includes(mut) ? 0 : 1, "Cluster": mut};
              for (let i in aliases) {
                mut_dat[aliases[i] + " CCF"] = cluster_muts[mut].ccf_hat[i] + " (" + cluster_muts[mut].alt_cnt[i] + ":" + cluster_muts[mut].ref_cnt[i] + ")";
              }
              mut_data.push(mut_dat);
            }
            row.child("<table id=\"cluster_" + cluster.toString() + "_table\" class=\"hover\"></table>").show();
            cluster_table = $("#cluster_" + cluster.toString() + "_table").DataTable({
              "columns": [{"data": "is_driver", "visible": false}].concat(this._elements.column_data),
              "data": mut_data,
              "autoWidth": false,
              "order": [[0, "asc"]],
              "paging": false,
              "scrollY": 320,
              "scrollCollapse": true,
              "createdRow": function(row, data) {
                $(row).css("color", color);
                if (data.is_driver === 0) {
                  $(row).css("font-weight", "bold");
                }
              }
            });
          } else {
            cluster_table = row.child.DataTable();
          }
          return cluster_table;
        },

        hide_mutations: function(cluster) {
          this._elements.cluster_datatable.row(cluster - 1).child.hide();
        }

      });

      $("#cluster-table").cluster_table({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [1.0, 1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"]}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"]}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"]}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"]}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"]}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"]}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"]}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"]}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"]}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"]}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"]}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"]}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"]}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"]}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"]}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"]}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"]}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"]}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"]}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"]}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"]}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"]}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"]}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"]}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"]}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"]}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"]}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"]}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"]}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"]}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"]}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"]}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"]}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"]}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"]}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"]}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"]}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"]}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"]}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"]}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"]}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"]}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"]}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.9403, 0.7211, 0.0096, 0.293], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"]}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"]}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"]}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"]}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"]}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"]}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"]}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"]}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"]}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"]}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"]}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"]}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"]}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"]}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"]}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"]}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"]}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"]}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"]}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"]}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.010700000000000001, 0.0901, 0.7984, 0.030299999999999997], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"]}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"]}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"]}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"]}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"]}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"]}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"]}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"]}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"]}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"]}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"]}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"]}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"]}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"]}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"]}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"]}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"]}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"]}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"]}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"]}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"]}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"]}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"]}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"]}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"]}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"]}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"]}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"]}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"]}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"]}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"]}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"]}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.013500000000000002, 0.0356, 0.1532, 0.6598], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"]}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"]}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"]}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"]}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"]}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"]}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"]}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"]}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"]}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"]}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"]}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"]}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"]}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"]}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"]}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"]}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"]}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"]}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"]}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"]}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"]}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"]}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"]}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"]}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"]}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"]}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"]}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"]}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"]}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"]}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"]}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"]}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"]}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"]}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"]}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"]}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"]}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"]}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"]}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"]}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"]}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"]}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"]}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"]}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"]}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"]}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"]}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"]}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"]}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"]}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"]}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"]}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"]}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"]}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"]}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"]}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"]}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"]}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"]}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"]}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"]}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"]}}, "line_width": 12}}, "aliases": ["sample_00", "sample_01", "sample_02", "sample_03"]})
    });
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.mutation_plot", {
        options: {
          xlabels: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], line_width: 0, color: "green", drivers: []}},
          width: 500,
          height: 400,
          margins: {top: 20, right: 30, bottom: 35, left: 40}
        },

        _elements: {
          mutation_plot: undefined
        },

        _create: function() {
          const xlabels = this.options.xlabels,
            cluster_dict = this.options.cluster_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          if (xlabels.length > 1) {
            let x = d3.scaleLinear()
              .domain([0, xlabels.length - 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, 1])
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x).tickValues([...Array(xlabels.length).keys()]).tickFormat(d => xlabels[d]));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let line = d3.line()
              .x(d => x(d.x))
              .y(d => y(d.y));

            let mutation_plot = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .style("max-width", "500px")
              .style("min-width", "300px")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
            mutation_plot.append("g")
              .call(xAxis);
            mutation_plot.append("g")
              .call(yAxis);
            mutation_plot.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Samples");
            mutation_plot.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            mutation_plot.append("text")
              .attr("x", width / 2)
              .attr("y", margins.top / 2)
              .attr("text-anchor", "middle")
              .style("font-size", "14px")
              .style("text-decoration", "underline")
              .text("Mutation plot");

            for (let cluster in cluster_dict) {
              let muts = cluster_dict[cluster].muts,
                color = cluster_dict[cluster].color;
              for (let mut in muts) {
                let ccf_hat = muts[mut].ccf_hat,
                  mutation_data = [];
                for (let sample in ccf_hat) {
                  mutation_data.push({
                    x: sample,
                    y: ccf_hat[sample]
                  });
                }
                mutation_plot.append("path")
                  .datum(mutation_data)
                  .attr("fill", "none")
                  .attr("stroke", color)
                  .attr("stroke-width", 3)
                  .attr("opacity", 0.3)
                  .attr("d", line);
              }
            }

            this._elements.mutation_plot = mutation_plot.node();
          } else {
            let max_bin = 0,
              n_bins;
            for (let c in cluster_dict) {
              for (let mut in cluster_dict[c].muts) {
                max_bin = Math.max(max_bin, ...cluster_dict[c].muts[mut].ccf_dist);
                n_bins = cluster_dict[c].muts[mut].ccf_dist.length
              }
            }
            let x = d3.scaleLinear()
              .domain([0, 1])
              .range([margins.left, width - margins.right]);

            let y = d3.scaleLinear()
              .domain([0, max_bin]).nice()
              .range([height - margins.bottom, margins.top]);

            let xAxis = g => g
              .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
              .call(d3.axisBottom(x));

            let yAxis = g => g
              .attr("transform", "translate(" + margins.left.toString() + " 0)")
              .call(d3.axisLeft(y));

            let plot_1d = d3.select(document.createElement("svg"))
              .attr("baseProfile", "full")
              .attr("viewBox", "0 0 " + width + " " + height)
              .style("max-width", "500px")
              .style("min-width", "300px")
              .attr("version", "1.1")
              .attr("xmlns", "http://www.w3.org/2000/svg")
              .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
              .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
            plot_1d.append("g")
              .call(xAxis);
            plot_1d.append("g")
              .call(yAxis);
            plot_1d.append("text")
              .attr("x", (width + margins.left - margins.right) / 2)
              .attr("y", height - 5)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("CCF(x)");
            plot_1d.append("text")
              .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
              .attr("x", 10)
              .attr("y", (height + margins.top - margins.bottom) / 2)
              .style("text-anchor", "middle")
              .attr("font-size", "10px")
              .text("Probability density");

            let zero_str = Array(n_bins).fill(0).reduce(
              (a, c, i) => a + " " + x((n_bins - i - 1) / (n_bins - 1)).toString() + "," + y(0).toString(), " "
            );

            for (let c in cluster_dict) {
              plot_1d.append("g")
                .selectAll("polygon")
                .data(Object.keys(cluster_dict[c].muts))
                .join("polygon")
                .attr("fill", cluster_dict[c].color)
                .attr("opacity", 0.05)
                .attr("stroke", "none")
                .attr("points", d =>
                  cluster_dict[c].muts[d].ccf_dist.reduce(
                    (a, c, i) => a + " " + x(i / (n_bins - 1)).toString() + "," + y(c).toString(), ""
                  ) + zero_str
                );
            }

            plot_1d.append("text")
              .attr("x", width / 2)
              .attr("y", margins.top / 2)
              .attr("text-anchor", "middle")
              .style("font-size", "14px")
              .style("text-decoration", "underline")
              .text("Mutation plot");

            this._elements.mutation_plot = plot_1d.node()
          }

          this._refresh();

        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.mutation_plot.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.mutation_plot.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".mutation_plot.svg");
          dl.click();
        }
      });

      $("#mutation-plot").mutation_plot({"cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [1.0, 1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"]}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"]}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"]}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"]}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"]}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"]}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"]}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"]}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"]}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"]}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"]}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"]}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"]}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"]}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"]}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"]}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"]}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"]}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"]}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"]}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"]}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"]}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"]}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"]}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"]}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"]}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"]}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"]}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"]}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"]}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"]}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"]}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"]}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"]}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"]}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"]}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"]}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"]}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"]}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"]}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"]}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"]}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"]}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.9403, 0.7211, 0.0096, 0.293], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"]}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"]}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"]}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"]}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"]}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"]}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"]}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"]}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"]}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"]}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"]}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"]}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"]}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"]}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"]}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"]}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"]}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"]}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"]}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"]}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.010700000000000001, 0.0901, 0.7984, 0.030299999999999997], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"]}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"]}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"]}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"]}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"]}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"]}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"]}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"]}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"]}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"]}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"]}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"]}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"]}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"]}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"]}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"]}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"]}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"]}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"]}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"]}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"]}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"]}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"]}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"]}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"]}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"]}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"]}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"]}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"]}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"]}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"]}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"]}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.013500000000000002, 0.0356, 0.1532, 0.6598], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"]}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"]}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"]}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"]}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"]}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"]}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"]}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"]}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"]}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"]}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"]}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"]}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"]}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"]}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"]}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"]}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"]}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"]}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"]}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"]}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"]}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"]}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"]}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"]}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"]}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"]}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"]}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"]}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"]}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"]}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"]}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"]}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"]}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"]}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"]}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"]}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"]}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"]}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"]}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"]}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"]}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"]}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"]}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"]}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"]}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"]}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"]}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"]}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"]}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"]}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"]}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"]}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"]}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"]}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"]}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"]}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"]}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"]}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"]}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"]}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"]}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"]}}, "line_width": 12}}, "xlabels": ["sample_00", "sample_01", "sample_02", "sample_03"]})
    })
  </script>
  <script>
    $(function() {
      $.widget("PhylogicNDT_report.fish_plot", {
        options: {
          xlabels: [],
          time_points: [],
          tumor_sizes: [],
          cluster_dict: {1: {ccf_hat: [0], ccf_high: [0], ccf_low: [0], line_width: 0, color: "green", drivers: []}},
          child_dict: {},
          width: 500,
          height: 400,
          margins: {top: 20, right: 30, bottom: 35, left: 40}
        },

        _elements: {
          fish_plot: undefined
        },

        _create: function() {
          const xlabels = this.options.xlabels,
            time_points = this.options.time_points,
            tumor_sizes = this.options.tumor_sizes,
            cluster_dict = this.options.cluster_dict,
            child_dict = this.options.child_dict,
            width = this.options.width,
            height = this.options.height,
            margins = this.options.margins;

          let x = d3.scaleLinear()
            .domain([Math.min(...time_points), Math.max(...time_points)])
            .range([margins.left, width - margins.right]);

          let y = d3.scaleLinear()
            .domain([0, Math.max(...tumor_sizes)]).nice()
            .range([height - margins.bottom, margins.top]);

          let xAxis = g => g
            .attr("transform", "translate(0 " + (height - margins.bottom).toString() + ")")
            .call(d3.axisBottom(x));

          let yAxis = g => g
            .attr("transform", "translate(" + margins.left.toString() + " 0)")
            .call(d3.axisLeft(y));

          let h = [];
          for (let i in xlabels) {
            h.push(time_points[i] - time_points[i - 1]);
          }

          let weights_cache = {};

          let pchip = function(u, population, c) {
            if (u < time_points[0] || u > time_points[time_points.length - 1]) {
              throw "Input outside interpolation range";
            }
            if (u === time_points[time_points.length - 1]) {
              return population[time_points.length - 1]
            }
            let n;
            for (n in time_points) {
              if (time_points[n] > u) {
                n = parseInt(n);
                break;
              }
            }
            weights_cache[c] = weights_cache[c] || {};
            let p0, p1, fp0, fp1;
            if (weights_cache[c][n]) {
              p0 = weights_cache[c][n].p0;
              p1 = weights_cache[c][n].p1;
              fp0 = weights_cache[c][n].fp0;
              fp1 = weights_cache[c][n].fp1;
            } else {
              p0 = population[n - 1];
              p1 = population[n];
              let d0 = (p0 - population[n - 2]) / h[n - 1],
                d1 = (p1 - p0) / h[n],
                d2 = (population[n + 1] - p1) / h[n + 1];
              fp0 = n === 1 ? d1 : (d0 + d1) / 2;
              fp1 = n === xlabels.length - 1 ? d1 : (d1 + d2) / 2;
              weights_cache[c][n] = {p0: p0, p1: p1, fp0: fp0, fp1: fp1};
            }
            let v = (u - time_points[n - 1]) / (time_points[n] - time_points[n - 1]);
            return (p0 * ((2 * v * v * v) - (3 * v * v) + 1)) +
              (p1 * ((-2 * v * v * v) + (3 * v * v))) +
              (fp0 * ((v * v * v) - (2 * v * v) + v)) +
              (fp1 * ((v * v * v) - (v * v)))
          };

          let getOrder = function(cluster, level) {
            cluster = cluster || child_dict[null][0];
            level = level || 1;
            let order = [cluster],
              breaks = {},
              children = child_dict[cluster];
            for (let i in children) {
              let {order: child_order, breaks: child_breaks, level: child_level} = getOrder(children[i], level + 1);
              order = [...order, ...child_order];
              breaks[children[i]] = children.length > 1 ? child_level : false;
              breaks = Object.assign({}, breaks, child_breaks);
            }
            return {order: order, breaks: breaks, level: level}
          };

          let {order, breaks} = getOrder(),
            max_break = Math.max(...Object.values(breaks));

          let fish_plot = d3.select(document.createElement("svg"))
            .attr("baseProfile", "full")
            .attr("viewBox", "0 0 " + width + " " + height)
            .style("max-width", "500px")
            .style("min-width", "300px")
            .attr("version", "1.1")
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("xmlns:ev", "http://www.w3.org/2001/xml-events")
            .attr("xmlns:xlink", "http://www.w3.org/1999/xlink");
          fish_plot.append("g")
            .call(xAxis);
          fish_plot.append("g")
            .call(yAxis);
          fish_plot.append("text")
            .attr("x", (width + margins.left - margins.right) / 2)
            .attr("y", height - 5)
            .style("text-anchor", "middle")
            .attr("font-size", "10px")
            .text("Time");
          fish_plot.append("text")
            .attr("transform", "rotate(-90 10 " + ((height + margins.top - margins.bottom) / 2).toString() + ")")
            .attr("x", 10)
            .attr("y", (height + margins.top - margins.bottom) / 2)
            .style("text-anchor", "middle")
            .attr("font-size", "10px")
            .text("Relative size");
          fish_plot.append("text")
            .attr("x", width / 2)
            .attr("y", margins.top / 2)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .style("text-decoration", "underline")
            .text("Tumor abundance plot");

          let t0 = time_points[0],
            linspace = [t0],
            step = (time_points[time_points.length - 1] - t0) / 100;
          for (let i = 1; i < 101; i++) {
            linspace.push(i * step + t0);
          }

          let abundance_stack = Array(101).fill(0);

          for (let o in order) {
            let cluster = order[order.length - o - 1],
              unique_population = child_dict[cluster].reduce(
                (a, c) => a.map((d, i) => d - cluster_dict[c].tumor_abundance[i]), cluster_dict[cluster].tumor_abundance
              ),
              base = [],
              head = [];
            for (let i in linspace) {
              base.push(x(linspace[i]) + "," + y(abundance_stack[i]));
              abundance_stack[i] += pchip(linspace[i], unique_population, cluster);
              head.push(x(linspace[i]) + "," + y(abundance_stack[i]));
            }
            fish_plot.append("path")
              .datum(linspace)
              .attr("stroke", cluster_dict[cluster].color)
              .attr("stroke-width", breaks[cluster] ? max_break - breaks[cluster] + 1 : 0)
              .attr("stroke-dasharray", 4)
              .attr("fill", "none")
              .attr("opacity", 1.0)
              .attr("d", d3.line()
                .x(d => x(d))
                .y((d, i) => y(abundance_stack[i])));

            fish_plot.append("polygon")
              .attr("points", head.join(" ") + " " + base.reverse().join(" "))
              .attr("fill", cluster_dict[cluster].color)
              .attr("opacity", 0.5)
              .attr("stroke", "none");
          }
          fish_plot.append("g")
            .selectAll("line")
            .data(time_points)
            .join("line")
            .attr("x1", d => x(d))
            .attr("y1", y.range()[0])
            .attr("x2", d => x(d))
            .attr("y2", y.range()["length"] + margins.top)
            .attr("stroke", "black")
            .attr("stroke-width", 1)
            .attr("stroke-dasharray", "1 4");

          this._elements.fish_plot = fish_plot.node();

          this._refresh();

          d3.select(this.element.context.parentElement).append("button")
            .attr("onclick", "$(\"#fish-plot\").fish_plot(\"download\")")
            .attr("style", "font-size: 12px;")
            .html("Download as SVG")

        },

        _refresh: function() {
          this.element.context.innerHTML = this._elements.fish_plot.outerHTML;
        },

        download: function() {
          let dl_link = "data:text/plain;charset=utf-8," + encodeURIComponent(this._elements.fish_plot.outerHTML),
            dl = document.createElement("a");
          document.body.appendChild(dl);
          dl.setAttribute("href", dl_link);
          dl.setAttribute("download", "Example_ND" + ".tumor_abundance_plot.svg");
          dl.click();
        }
      });

      let fish_options = {"tumor_sizes": [1.0, 1.0, 1.0, 1.0], "xlabels": ["sample_00", "sample_01", "sample_02", "sample_03"], "child_dict": {"1": [2, 3, 4], "null": [1], "3": [], "4": [], "2": []}, "time_points": [0.0, 1.0, 2.0, 3.0], "cluster_dict": {"1": {"ccf_hat": [0.97, 0.99, 0.93, 0.97], "tumor_abundance": [1.0, 1.0, 1.0, 1.0], "ccf_high": [1.0, 1.0, 0.98, 1.0], "color": "rgb(39,140,24)", "drivers": [], "ccf_low": [0.94, 0.97, 0.88, 0.94], "muts": {"chr1:203116592:A:T": {"ref_cnt": ["38", "41", "35", "20"], "ccf_hat": [0.87, 0.9, 0.84, 0.78], "alt_cnt": ["11", "24", "10", "7"]}, "chr6:54069115:A:T": {"ref_cnt": ["72", "22", "39", "43"], "ccf_hat": [0.84, 0.91, 0.9, 0.89], "alt_cnt": ["16", "27", "17", "27"]}, "chr6:31180141:A:T": {"ref_cnt": ["42", "20", "77", "28"], "ccf_hat": [0.86, 0.94, 0.81, 0.88], "alt_cnt": ["12", "30", "19", "19"]}, "chr16:12137783:A:T": {"ref_cnt": ["155", "108", "123", "115"], "ccf_hat": [0.86, 0.95, 0.9, 0.83], "alt_cnt": ["42", "79", "44", "49"]}, "chr4:12358155:A:T": {"ref_cnt": ["117", "79", "128", "132"], "ccf_hat": [0.83, 0.93, 0.69, 0.76], "alt_cnt": ["15", "29", "13", "21"]}, "chr5:39128627:A:T": {"ref_cnt": ["80", "75", "117", "42"], "ccf_hat": [0.76, 0.94, 0.91, 0.73], "alt_cnt": ["9", "30", "24", "7"]}, "chr6:1417608:A:T": {"ref_cnt": ["48", "39", "70", "48"], "ccf_hat": [0.77, 0.87, 0.82, 0.93], "alt_cnt": ["9", "35", "18", "35"]}, "chr10:44150814:A:T": {"ref_cnt": ["85", "190", "108", "160"], "ccf_hat": [0.87, 0.74, 0.89, 0.78], "alt_cnt": ["14", "33", "20", "26"]}, "chr14:41194468:A:T": {"ref_cnt": ["25", "21", "13", "13"], "ccf_hat": [0.71, 0.89, 0.77, 0.88], "alt_cnt": ["4", "15", "4", "10"]}, "chr1:83112457:A:T": {"ref_cnt": ["18", "47", "66", "17"], "ccf_hat": [0.61, 0.88, 0.61, 0.76], "alt_cnt": ["2", "24", "8", "6"]}, "chr7:125483252:A:T": {"ref_cnt": ["97", "127", "121", "105"], "ccf_hat": [0.85, 0.71, 0.92, 0.74], "alt_cnt": ["14", "21", "26", "16"]}, "chr1:132144794:A:T": {"ref_cnt": ["14", "28", "23", "27"], "ccf_hat": [0.65, 0.84, 0.82, 0.81], "alt_cnt": ["2", "14", "7", "10"]}, "chr6:74165244:A:T": {"ref_cnt": ["55", "19", "48", "35"], "ccf_hat": [0.9, 0.85, 0.85, 0.79], "alt_cnt": ["17", "18", "15", "16"]}, "chr8:23624864:A:T": {"ref_cnt": ["7", "32", "29", "19"], "ccf_hat": [0.81, 0.93, 0.75, 0.75], "alt_cnt": ["4", "25", "6", "6"]}, "chr11:71847859:A:T": {"ref_cnt": ["29", "21", "30", "19"], "ccf_hat": [0.79, 0.81, 0.86, 0.84], "alt_cnt": ["6", "10", "10", "9"]}, "chr10:2401524:A:T": {"ref_cnt": ["133", "88", "53", "245"], "ccf_hat": [0.84, 0.82, 0.7, 0.85], "alt_cnt": ["17", "19", "6", "45"]}, "chr2:155758820:A:T": {"ref_cnt": ["84", "246", "155", "244"], "ccf_hat": [0.75, 0.92, 0.91, 0.93], "alt_cnt": ["9", "62", "29", "58"]}, "chr1:216025272:A:T": {"ref_cnt": ["34", "9", "27", "35"], "ccf_hat": [0.88, 0.81, 0.66, 0.88], "alt_cnt": ["11", "6", "4", "16"]}, "chr9:54906067:A:T": {"ref_cnt": ["74", "31", "102", "71"], "ccf_hat": [0.77, 0.93, 0.72, 0.89], "alt_cnt": ["13", "39", "20", "40"]}, "chr16:4448042:A:T": {"ref_cnt": ["167", "98", "118", "114"], "ccf_hat": [0.93, 0.76, 0.86, 0.89], "alt_cnt": ["30", "18", "19", "27"]}, "chr11:42572643:A:T": {"ref_cnt": ["27", "22", "21", "20"], "ccf_hat": [0.7, 0.86, 0.76, 0.88], "alt_cnt": ["4", "13", "5", "12"]}, "chr8:68794502:A:T": {"ref_cnt": ["26", "26", "21", "32"], "ccf_hat": [0.83, 0.73, 0.8, 0.71], "alt_cnt": ["7", "9", "6", "8"]}, "chr2:221118783:A:T": {"ref_cnt": ["158", "93", "105", "94"], "ccf_hat": [0.87, 0.91, 0.77, 0.73], "alt_cnt": ["22", "28", "13", "14"]}, "chr16:60609731:A:T": {"ref_cnt": ["119", "101", "85", "61"], "ccf_hat": [0.87, 0.98, 0.92, 0.93], "alt_cnt": ["55", "179", "57", "69"]}, "chr11:132617216:A:T": {"ref_cnt": ["22", "52", "27", "31"], "ccf_hat": [0.78, 0.92, 0.72, 0.92], "alt_cnt": ["5", "31", "5", "20"]}, "chr2:134658375:A:T": {"ref_cnt": ["113", "112", "96", "174"], "ccf_hat": [0.54, 0.93, 0.7, 0.69], "alt_cnt": ["7", "35", "10", "24"]}, "chr11:85707387:A:T": {"ref_cnt": ["17", "20", "26", "37"], "ccf_hat": [0.8, 0.61, 0.81, 0.7], "alt_cnt": ["5", "5", "7", "9"]}, "chr4:37112458:A:T": {"ref_cnt": ["90", "173", "74", "121"], "ccf_hat": [0.8, 0.87, 0.91, 0.92], "alt_cnt": ["11", "40", "18", "32"]}, "chr20:49921552:A:T": {"ref_cnt": ["38", "14", "33", "8"], "ccf_hat": [0.43, 0.89, 0.61, 0.63], "alt_cnt": ["2", "12", "4", "2"]}, "chr10:86906761:A:T": {"ref_cnt": ["164", "160", "49", "135"], "ccf_hat": [0.92, 0.94, 0.89, 0.9], "alt_cnt": ["53", "108", "21", "67"]}, "chr12:85192368:A:T": {"ref_cnt": ["94", "61", "122", "100"], "ccf_hat": [0.91, 0.87, 0.7, 0.85], "alt_cnt": ["21", "21", "15", "25"]}, "chr1:26433505:A:T": {"ref_cnt": ["29", "42", "55", "39"], "ccf_hat": [0.69, 0.9, 0.72, 0.85], "alt_cnt": ["4", "25", "9", "15"]}, "chr17:77961642:A:T": {"ref_cnt": ["70", "83", "97", "80"], "ccf_hat": [0.91, 0.91, 0.85, 0.93], "alt_cnt": ["18", "31", "18", "30"]}, "chr7:23190612:A:T": {"ref_cnt": ["212", "96", "111", "93"], "ccf_hat": [0.83, 0.88, 0.68, 0.91], "alt_cnt": ["25", "25", "11", "25"]}, "chr18:59256965:A:T": {"ref_cnt": ["106", "94", "119", "127"], "ccf_hat": [0.85, 0.94, 0.71, 0.96], "alt_cnt": ["29", "68", "28", "83"]}, "chr3:7953112:A:T": {"ref_cnt": ["155", "32", "220", "101"], "ccf_hat": [0.77, 0.76, 0.87, 0.58], "alt_cnt": ["16", "7", "33", "11"]}, "chr1:119718772:A:T": {"ref_cnt": ["54", "68", "38", "27"], "ccf_hat": [0.86, 0.81, 0.89, 0.78], "alt_cnt": ["12", "27", "14", "9"]}, "chr12:51515436:A:T": {"ref_cnt": ["42", "30", "121", "78"], "ccf_hat": [0.76, 0.84, 0.83, 0.71], "alt_cnt": ["6", "11", "20", "14"]}, "chr15:51641272:A:T": {"ref_cnt": ["14", "17", "23", "19"], "ccf_hat": [0.84, 0.82, 0.69, 0.86], "alt_cnt": ["6", "9", "4", "10"]}, "chr3:177467084:A:T": {"ref_cnt": ["124", "83", "119", "147"], "ccf_hat": [0.61, 0.65, 0.72, 0.94], "alt_cnt": ["9", "12", "13", "42"]}, "chr2:159443742:A:T": {"ref_cnt": ["94", "90", "75", "67"], "ccf_hat": [0.86, 0.92, 0.77, 0.91], "alt_cnt": ["27", "61", "20", "38"]}, "chr15:9208331:A:T": {"ref_cnt": ["37", "38", "10", "34"], "ccf_hat": [0.7, 0.86, 0.66, 0.79], "alt_cnt": ["5", "19", "2", "11"]}, "chr8:11016138:A:T": {"ref_cnt": ["34", "35", "23", "32"], "ccf_hat": [0.89, 0.62, 0.62, 0.85], "alt_cnt": ["12", "9", "3", "13"]}}, "line_width": 12}, "2": {"ccf_hat": [0.95, 0.72, 0.01, 0.3], "tumor_abundance": [0.9403, 0.7211, 0.0096, 0.293], "ccf_high": [1.0, 0.77, 0.01, 0.34], "color": "rgb(103,200,243)", "drivers": [], "ccf_low": [0.9, 0.68, 0.01, 0.26], "muts": {"chr4:93217970:A:T": {"ref_cnt": ["206", "152", "70", "88"], "ccf_hat": [0.79, 0.75, 0.1, 0.35], "alt_cnt": ["22", "27", "0", "5"]}, "chr9:109685447:A:T": {"ref_cnt": ["50", "21", "47", "46"], "ccf_hat": [0.89, 0.87, 0.08, 0.53], "alt_cnt": ["16", "21", "0", "11"]}, "chr8:85404603:A:T": {"ref_cnt": ["24", "40", "8", "28"], "ccf_hat": [0.81, 0.87, 0.37, 0.34], "alt_cnt": ["6", "21", "0", "2"]}, "chr9:26310976:A:T": {"ref_cnt": ["68", "50", "82", "48"], "ccf_hat": [0.86, 0.66, 0.05, 0.2], "alt_cnt": ["16", "26", "0", "3"]}, "chr12:83082752:A:T": {"ref_cnt": ["53", "26", "139", "124"], "ccf_hat": [0.86, 0.72, 0.02, 0.36], "alt_cnt": ["19", "15", "0", "22"]}, "chr12:59892443:A:T": {"ref_cnt": ["107", "116", "154", "109"], "ccf_hat": [0.88, 0.76, 0.02, 0.29], "alt_cnt": ["36", "73", "0", "15"]}, "chr15:61601382:A:T": {"ref_cnt": ["30", "23", "31", "10"], "ccf_hat": [0.78, 0.82, 0.16, 0.27], "alt_cnt": ["6", "11", "0", "0"]}, "chr3:112792751:A:T": {"ref_cnt": ["38", "56", "105", "55"], "ccf_hat": [0.53, 0.75, 0.02, 0.37], "alt_cnt": ["8", "47", "0", "13"]}, "chr2:1276028:A:T": {"ref_cnt": ["29", "166", "77", "104"], "ccf_hat": [0.74, 0.62, 0.09, 0.61], "alt_cnt": ["4", "23", "0", "12"]}, "chr9:5488020:A:T": {"ref_cnt": ["40", "60", "140", "58"], "ccf_hat": [0.77, 0.66, 0.03, 0.13], "alt_cnt": ["8", "31", "0", "2"]}, "chr2:195739636:A:T": {"ref_cnt": ["157", "207", "193", "175"], "ccf_hat": [0.88, 0.75, 0.03, 0.18], "alt_cnt": ["23", "37", "0", "5"]}, "chr3:4967308:A:T": {"ref_cnt": ["123", "104", "126", "102"], "ccf_hat": [0.79, 0.76, 0.05, 0.31], "alt_cnt": ["14", "19", "0", "5"]}, "chr18:3791536:A:T": {"ref_cnt": ["150", "170", "182", "194"], "ccf_hat": [0.91, 0.63, 0.04, 0.32], "alt_cnt": ["25", "24", "0", "11"]}, "chr13:43978569:A:T": {"ref_cnt": ["42", "25", "13", "36"], "ccf_hat": [0.8, 0.54, 0.3, 0.18], "alt_cnt": ["8", "5", "0", "1"]}, "chr20:34878520:A:T": {"ref_cnt": ["13", "33", "24", "15"], "ccf_hat": [0.73, 0.69, 0.2, 0.61], "alt_cnt": ["3", "10", "0", "3"]}, "chr1:192607152:A:T": {"ref_cnt": ["23", "29", "32", "29"], "ccf_hat": [0.86, 0.48, 0.15, 0.42], "alt_cnt": ["8", "5", "0", "3"]}, "chr1:108730876:A:T": {"ref_cnt": ["35", "9", "16", "15"], "ccf_hat": [0.8, 0.66, 0.26, 0.38], "alt_cnt": ["7", "3", "0", "1"]}, "chr16:83054051:A:T": {"ref_cnt": ["88", "88", "135", "132"], "ccf_hat": [0.9, 0.77, 0.05, 0.5], "alt_cnt": ["17", "17", "0", "12"]}, "chr7:1739320:A:T": {"ref_cnt": ["176", "60", "197", "101"], "ccf_hat": [0.77, 0.61, 0.03, 0.26], "alt_cnt": ["18", "8", "0", "4"]}, "chr11:81918530:A:T": {"ref_cnt": ["39", "32", "35", "13"], "ccf_hat": [0.62, 0.61, 0.14, 0.23], "alt_cnt": ["4", "8", "0", "0"]}}, "line_width": 9.0}, "3": {"ccf_hat": [0.01, 0.09, 0.8, 0.03], "tumor_abundance": [0.010700000000000001, 0.0901, 0.7984, 0.030299999999999997], "ccf_high": [0.02, 0.1, 0.85, 0.04], "color": "rgb(248,139,16)", "drivers": [], "ccf_low": [0.01, 0.08, 0.74, 0.03], "muts": {"chr11:72779563:A:T": {"ref_cnt": ["24", "19", "35", "19"], "ccf_hat": [0.23, 0.13, 0.59, 0.17], "alt_cnt": ["0", "0", "4", "0"]}, "chr15:74631626:A:T": {"ref_cnt": ["17", "49", "36", "20"], "ccf_hat": [0.29, 0.17, 0.49, 0.16], "alt_cnt": ["0", "2", "3", "0"]}, "chr11:105419584:A:T": {"ref_cnt": ["34", "50", "17", "19"], "ccf_hat": [0.17, 0.26, 0.74, 0.32], "alt_cnt": ["0", "4", "4", "1"]}, "chr13:31235332:A:T": {"ref_cnt": ["47", "13", "41", "38"], "ccf_hat": [0.13, 0.19, 0.72, 0.09], "alt_cnt": ["0", "0", "7", "0"]}, "chr15:100671545:A:T": {"ref_cnt": ["19", "9", "24", "13"], "ccf_hat": [0.47, 0.25, 0.78, 0.23], "alt_cnt": ["1", "0", "6", "0"]}, "chr12:10181887:A:T": {"ref_cnt": ["41", "37", "68", "227"], "ccf_hat": [0.08, 0.1, 0.95, 0.04], "alt_cnt": ["0", "1", "43", "3"]}, "chr8:85536002:A:T": {"ref_cnt": ["20", "10", "38", "44"], "ccf_hat": [0.26, 0.23, 0.48, 0.07], "alt_cnt": ["0", "0", "3", "0"]}, "chr12:89396230:A:T": {"ref_cnt": ["153", "301", "55", "132"], "ccf_hat": [0.04, 0.06, 0.81, 0.07], "alt_cnt": ["0", "4", "10", "1"]}, "chr2:117890927:A:T": {"ref_cnt": ["77", "241", "51", "145"], "ccf_hat": [0.1, 0.1, 0.79, 0.08], "alt_cnt": ["0", "4", "8", "1"]}, "chr11:77188078:A:T": {"ref_cnt": ["32", "39", "28", "37"], "ccf_hat": [0.18, 0.14, 0.57, 0.09], "alt_cnt": ["0", "1", "3", "0"]}, "chr4:113590408:A:T": {"ref_cnt": ["118", "167", "37", "212"], "ccf_hat": [0.03, 0.08, 0.8, 0.05], "alt_cnt": ["0", "5", "12", "3"]}, "chr10:15280573:A:T": {"ref_cnt": ["71", "97", "45", "133"], "ccf_hat": [0.11, 0.15, 0.62, 0.04], "alt_cnt": ["0", "2", "4", "0"]}, "chr9:140287925:A:T": {"ref_cnt": ["70", "30", "126", "128"], "ccf_hat": [0.07, 0.17, 0.75, 0.02], "alt_cnt": ["0", "2", "26", "0"]}, "chr14:83027451:A:T": {"ref_cnt": ["42", "77", "20", "23"], "ccf_hat": [0.14, 0.24, 0.72, 0.14], "alt_cnt": ["0", "6", "4", "0"]}, "chr17:28217979:A:T": {"ref_cnt": ["92", "127", "59", "182"], "ccf_hat": [0.07, 0.15, 0.86, 0.02], "alt_cnt": ["0", "4", "13", "0"]}, "chr5:107026837:A:T": {"ref_cnt": ["96", "38", "102", "273"], "ccf_hat": [0.17, 0.12, 0.82, 0.08], "alt_cnt": ["1", "0", "15", "3"]}, "chr17:76824397:A:T": {"ref_cnt": ["129", "164", "125", "277"], "ccf_hat": [0.05, 0.16, 0.42, 0.07], "alt_cnt": ["0", "6", "8", "3"]}, "chr3:194338870:A:T": {"ref_cnt": ["136", "303", "100", "213"], "ccf_hat": [0.12, 0.1, 0.81, 0.02], "alt_cnt": ["1", "5", "14", "0"]}, "chr5:646819:A:T": {"ref_cnt": ["146", "250", "118", "118"], "ccf_hat": [0.11, 0.13, 0.72, 0.09], "alt_cnt": ["1", "6", "13", "1"]}, "chr8:91541022:A:T": {"ref_cnt": ["25", "45", "21", "53"], "ccf_hat": [0.22, 0.34, 0.4, 0.06], "alt_cnt": ["0", "5", "1", "0"]}, "chr19:12629303:A:T": {"ref_cnt": ["30", "57", "43", "23"], "ccf_hat": [0.19, 0.1, 0.84, 0.14], "alt_cnt": ["0", "1", "11", "0"]}, "chr4:62487792:A:T": {"ref_cnt": ["139", "196", "117", "174"], "ccf_hat": [0.03, 0.06, 0.7, 0.03], "alt_cnt": ["0", "4", "27", "1"]}, "chr9:65899379:A:T": {"ref_cnt": ["59", "65", "94", "41"], "ccf_hat": [0.08, 0.11, 0.8, 0.06], "alt_cnt": ["0", "3", "22", "0"]}, "chr6:13811516:A:T": {"ref_cnt": ["88", "55", "87", "77"], "ccf_hat": [0.06, 0.13, 0.63, 0.13], "alt_cnt": ["0", "3", "14", "3"]}, "chr2:141016351:A:T": {"ref_cnt": ["137", "158", "20", "141"], "ccf_hat": [0.06, 0.09, 0.7, 0.03], "alt_cnt": ["0", "2", "3", "0"]}, "chr2:63180458:A:T": {"ref_cnt": ["112", "209", "101", "168"], "ccf_hat": [0.07, 0.05, 0.63, 0.07], "alt_cnt": ["0", "1", "9", "1"]}, "chr3:94346303:A:T": {"ref_cnt": ["107", "118", "57", "225"], "ccf_hat": [0.02, 0.13, 0.81, 0.05], "alt_cnt": ["0", "9", "29", "5"]}, "chr5:18405277:A:T": {"ref_cnt": ["168", "55", "126", "88"], "ccf_hat": [0.1, 0.08, 0.76, 0.12], "alt_cnt": ["1", "0", "15", "1"]}, "chr2:102011380:A:T": {"ref_cnt": ["205", "182", "169", "104"], "ccf_hat": [0.02, 0.14, 0.76, 0.08], "alt_cnt": ["0", "10", "44", "2"]}, "chr4:28312378:A:T": {"ref_cnt": ["212", "167", "70", "181"], "ccf_hat": [0.02, 0.11, 0.72, 0.03], "alt_cnt": ["0", "7", "17", "1"]}, "chr18:60319331:A:T": {"ref_cnt": ["150", "131", "69", "130"], "ccf_hat": [0.02, 0.05, 0.9, 0.08], "alt_cnt": ["0", "2", "28", "3"]}, "chr2:98710565:A:T": {"ref_cnt": ["121", "215", "92", "208"], "ccf_hat": [0.06, 0.09, 0.62, 0.05], "alt_cnt": ["0", "3", "8", "1"]}}, "line_width": 12}, "4": {"ccf_hat": [0.01, 0.04, 0.16, 0.67], "tumor_abundance": [0.013500000000000002, 0.0356, 0.1532, 0.6598], "ccf_high": [0.02, 0.04, 0.17, 0.69], "color": "rgb(16,49,41)", "drivers": [], "ccf_low": [0.01, 0.03, 0.14, 0.64], "muts": {"chr19:28003645:A:T": {"ref_cnt": ["27", "13", "39", "20"], "ccf_hat": [0.21, 0.35, 0.13, 0.85], "alt_cnt": ["0", "1", "0", "10"]}, "chr10:46572730:A:T": {"ref_cnt": ["122", "107", "143", "133"], "ccf_hat": [0.07, 0.05, 0.15, 0.72], "alt_cnt": ["1", "1", "5", "45"]}, "chr2:187507667:A:T": {"ref_cnt": ["118", "92", "138", "95"], "ccf_hat": [0.02, 0.05, 0.12, 0.63], "alt_cnt": ["0", "2", "6", "48"]}, "chr2:132632672:A:T": {"ref_cnt": ["162", "228", "157", "75"], "ccf_hat": [0.05, 0.04, 0.09, 0.78], "alt_cnt": ["0", "1", "1", "13"]}, "chr10:74945835:A:T": {"ref_cnt": ["237", "180", "109", "139"], "ccf_hat": [0.07, 0.05, 0.19, 0.63], "alt_cnt": ["1", "1", "2", "17"]}, "chr4:89478829:A:T": {"ref_cnt": ["148", "255", "88", "78"], "ccf_hat": [0.02, 0.02, 0.12, 0.69], "alt_cnt": ["0", "1", "2", "25"]}, "chr3:129183914:A:T": {"ref_cnt": ["251", "202", "177", "74"], "ccf_hat": [0.07, 0.05, 0.2, 0.68], "alt_cnt": ["1", "1", "4", "10"]}, "chr19:20753137:A:T": {"ref_cnt": ["23", "74", "30", "53"], "ccf_hat": [0.24, 0.03, 0.31, 0.71], "alt_cnt": ["0", "0", "1", "13"]}, "chr1:155732526:A:T": {"ref_cnt": ["31", "60", "16", "21"], "ccf_hat": [0.19, 0.09, 0.68, 0.52], "alt_cnt": ["0", "1", "3", "3"]}, "chr6:67586649:A:T": {"ref_cnt": ["104", "67", "63", "58"], "ccf_hat": [0.05, 0.08, 0.19, 0.63], "alt_cnt": ["0", "2", "2", "18"]}, "chr16:28689827:A:T": {"ref_cnt": ["106", "218", "85", "74"], "ccf_hat": [0.05, 0.04, 0.16, 0.68], "alt_cnt": ["1", "5", "5", "42"]}, "chr18:43153046:A:T": {"ref_cnt": ["139", "216", "93", "151"], "ccf_hat": [0.06, 0.05, 0.3, 0.56], "alt_cnt": ["0", "1", "3", "16"]}, "chr8:10234168:A:T": {"ref_cnt": ["22", "25", "32", "46"], "ccf_hat": [0.24, 0.1, 0.3, 0.62], "alt_cnt": ["0", "0", "1", "9"]}, "chr2:178187360:A:T": {"ref_cnt": ["147", "160", "140", "101"], "ccf_hat": [0.05, 0.09, 0.25, 0.66], "alt_cnt": ["0", "2", "4", "13"]}, "chr9:103609179:A:T": {"ref_cnt": ["43", "63", "86", "90"], "ccf_hat": [0.12, 0.06, 0.1, 0.6], "alt_cnt": ["0", "1", "1", "26"]}, "chr3:118852316:A:T": {"ref_cnt": ["110", "233", "143", "109"], "ccf_hat": [0.07, 0.04, 0.2, 0.55], "alt_cnt": ["0", "1", "3", "11"]}, "chr12:19536936:A:T": {"ref_cnt": ["144", "42", "92", "86"], "ccf_hat": [0.02, 0.04, 0.13, 0.63], "alt_cnt": ["0", "0", "3", "32"]}, "chr2:154784087:A:T": {"ref_cnt": ["154", "219", "185", "125"], "ccf_hat": [0.05, 0.07, 0.27, 0.74], "alt_cnt": ["0", "2", "6", "19"]}, "chr2:63896119:A:T": {"ref_cnt": ["85", "100", "219", "127"], "ccf_hat": [0.19, 0.04, 0.29, 0.82], "alt_cnt": ["1", "0", "8", "23"]}, "chr15:41548137:A:T": {"ref_cnt": ["31", "45", "34", "12"], "ccf_hat": [0.19, 0.06, 0.28, 0.84], "alt_cnt": ["0", "0", "1", "7"]}, "chr11:134953622:A:T": {"ref_cnt": ["17", "62", "13", "16"], "ccf_hat": [0.29, 0.04, 0.3, 0.83], "alt_cnt": ["0", "0", "0", "8"]}, "chr4:98907643:A:T": {"ref_cnt": ["124", "232", "144", "79"], "ccf_hat": [0.06, 0.1, 0.24, 0.56], "alt_cnt": ["0", "4", "4", "8"]}, "chr19:52225547:A:T": {"ref_cnt": ["14", "22", "44", "21"], "ccf_hat": [0.32, 0.23, 0.23, 0.72], "alt_cnt": ["0", "1", "1", "6"]}, "chr5:64764511:A:T": {"ref_cnt": ["34", "42", "89", "125"], "ccf_hat": [0.07, 0.14, 0.1, 0.67], "alt_cnt": ["0", "3", "3", "69"]}, "chr12:26863967:A:T": {"ref_cnt": ["62", "73", "106", "219"], "ccf_hat": [0.11, 0.1, 0.23, 0.5], "alt_cnt": ["0", "1", "3", "26"]}, "chr1:152412016:A:T": {"ref_cnt": ["16", "21", "20", "46"], "ccf_hat": [0.3, 0.12, 0.41, 0.66], "alt_cnt": ["0", "0", "1", "10"]}, "chr5:49140961:A:T": {"ref_cnt": ["185", "186", "138", "87"], "ccf_hat": [0.05, 0.04, 0.2, 0.58], "alt_cnt": ["1", "2", "7", "22"]}, "chr3:133235099:A:T": {"ref_cnt": ["78", "123", "103", "111"], "ccf_hat": [0.14, 0.05, 0.15, 0.56], "alt_cnt": ["3", "3", "6", "47"]}, "chr3:133203137:A:T": {"ref_cnt": ["71", "106", "119", "169"], "ccf_hat": [0.11, 0.13, 0.18, 0.85], "alt_cnt": ["0", "2", "2", "32"]}, "chr11:39857904:A:T": {"ref_cnt": ["34", "14", "41", "42"], "ccf_hat": [0.17, 0.18, 0.12, 0.37], "alt_cnt": ["0", "0", "0", "4"]}, "chr2:6236611:A:T": {"ref_cnt": ["66", "115", "91", "124"], "ccf_hat": [0.12, 0.04, 0.31, 0.74], "alt_cnt": ["0", "0", "3", "19"]}, "chr7:122826971:A:T": {"ref_cnt": ["131", "250", "134", "136"], "ccf_hat": [0.06, 0.08, 0.26, 0.73], "alt_cnt": ["0", "3", "4", "20"]}, "chr9:132378857:A:T": {"ref_cnt": ["111", "94", "26", "73"], "ccf_hat": [0.04, 0.06, 0.61, 0.71], "alt_cnt": ["0", "2", "4", "27"]}, "chr1:232770125:A:T": {"ref_cnt": ["21", "50", "12", "27"], "ccf_hat": [0.25, 0.05, 0.31, 0.78], "alt_cnt": ["0", "0", "0", "9"]}, "chr3:182891000:A:T": {"ref_cnt": ["98", "184", "137", "129"], "ccf_hat": [0.08, 0.05, 0.16, 0.77], "alt_cnt": ["0", "1", "2", "21"]}, "chr3:3079218:A:T": {"ref_cnt": ["235", "100", "153", "122"], "ccf_hat": [0.04, 0.06, 0.19, 0.62], "alt_cnt": ["2", "3", "12", "60"]}, "chr15:75412966:A:T": {"ref_cnt": ["26", "30", "25", "28"], "ccf_hat": [0.22, 0.09, 0.19, 0.7], "alt_cnt": ["0", "0", "0", "7"]}, "chr10:113935377:A:T": {"ref_cnt": ["184", "152", "75", "93"], "ccf_hat": [0.09, 0.06, 0.19, 0.88], "alt_cnt": ["1", "1", "1", "22"]}, "chr4:42944436:A:T": {"ref_cnt": ["84", "207", "247", "98"], "ccf_hat": [0.09, 0.02, 0.23, 0.83], "alt_cnt": ["0", "0", "7", "19"]}, "chr10:45446247:A:T": {"ref_cnt": ["50", "150", "63", "85"], "ccf_hat": [0.16, 0.03, 0.22, 0.58], "alt_cnt": ["0", "0", "1", "9"]}, "chr1:219296486:A:T": {"ref_cnt": ["14", "75", "41", "41"], "ccf_hat": [0.32, 0.11, 0.12, 0.31], "alt_cnt": ["0", "2", "0", "3"]}, "chr6:138504372:A:T": {"ref_cnt": ["52", "118", "91", "93"], "ccf_hat": [0.1, 0.03, 0.18, 0.68], "alt_cnt": ["0", "1", "3", "32"]}, "chr1:105180724:A:T": {"ref_cnt": ["44", "17", "21", "63"], "ccf_hat": [0.13, 0.15, 0.22, 0.53], "alt_cnt": ["0", "0", "0", "10"]}, "chr21:44658727:A:T": {"ref_cnt": ["41", "11", "19", "15"], "ccf_hat": [0.14, 0.21, 0.42, 0.81], "alt_cnt": ["0", "0", "1", "7"]}, "chr1:7333400:A:T": {"ref_cnt": ["46", "28", "45", "13"], "ccf_hat": [0.13, 0.09, 0.32, 0.64], "alt_cnt": ["0", "0", "2", "3"]}, "chr13:101288184:A:T": {"ref_cnt": ["44", "44", "13", "22"], "ccf_hat": [0.13, 0.12, 0.3, 0.66], "alt_cnt": ["0", "1", "0", "5"]}, "chr18:13213393:A:T": {"ref_cnt": ["92", "114", "228", "137"], "ccf_hat": [0.09, 0.17, 0.16, 0.52], "alt_cnt": ["0", "3", "4", "13"]}, "chr1:189508346:A:T": {"ref_cnt": ["17", "92", "36", "18"], "ccf_hat": [0.29, 0.03, 0.14, 0.65], "alt_cnt": ["0", "0", "0", "4"]}, "chr5:105791975:A:T": {"ref_cnt": ["103", "83", "141", "219"], "ccf_hat": [0.08, 0.11, 0.3, 0.63], "alt_cnt": ["0", "1", "5", "27"]}, "chr19:37085998:A:T": {"ref_cnt": ["37", "43", "25", "15"], "ccf_hat": [0.16, 0.13, 0.19, 0.61], "alt_cnt": ["0", "1", "0", "3"]}, "chr4:13768761:A:T": {"ref_cnt": ["154", "111", "83", "117"], "ccf_hat": [0.02, 0.02, 0.24, 0.73], "alt_cnt": ["0", "0", "5", "41"]}, "chr5:142128037:A:T": {"ref_cnt": ["168", "120", "123", "51"], "ccf_hat": [0.04, 0.08, 0.12, 0.76], "alt_cnt": ["0", "1", "1", "9"]}, "chr4:109006791:A:T": {"ref_cnt": ["83", "53", "117", "99"], "ccf_hat": [0.04, 0.04, 0.18, 0.6], "alt_cnt": ["0", "0", "5", "26"]}, "chr10:125649324:A:T": {"ref_cnt": ["140", "179", "124", "151"], "ccf_hat": [0.05, 0.05, 0.28, 0.65], "alt_cnt": ["0", "1", "4", "19"]}, "chr1:61872286:A:T": {"ref_cnt": ["24", "32", "37", "25"], "ccf_hat": [0.23, 0.08, 0.13, 0.73], "alt_cnt": ["0", "0", "0", "7"]}, "chr11:39379914:A:T": {"ref_cnt": ["17", "20", "26", "33"], "ccf_hat": [0.29, 0.13, 0.35, 0.77], "alt_cnt": ["0", "0", "1", "10"]}, "chr18:37378724:A:T": {"ref_cnt": ["204", "217", "42", "118"], "ccf_hat": [0.06, 0.04, 0.24, 0.75], "alt_cnt": ["2", "3", "2", "43"]}, "chr5:11911058:A:T": {"ref_cnt": ["179", "336", "95", "209"], "ccf_hat": [0.04, 0.06, 0.15, 0.81], "alt_cnt": ["0", "3", "1", "36"]}, "chr8:131534148:A:T": {"ref_cnt": ["20", "61", "43", "38"], "ccf_hat": [0.26, 0.09, 0.34, 0.73], "alt_cnt": ["0", "1", "2", "10"]}, "chr19:43375509:A:T": {"ref_cnt": ["38", "57", "29", "37"], "ccf_hat": [0.16, 0.04, 0.32, 0.86], "alt_cnt": ["0", "0", "1", "15"]}, "chr5:82474821:A:T": {"ref_cnt": ["99", "145", "77", "38"], "ccf_hat": [0.02, 0.11, 0.25, 0.73], "alt_cnt": ["0", "9", "8", "24"]}, "chr17:51719439:A:T": {"ref_cnt": ["142", "142", "142", "133"], "ccf_hat": [0.05, 0.02, 0.34, 0.62], "alt_cnt": ["0", "0", "7", "20"]}}, "line_width": 12}}};

      if (fish_options) {
        $("#fish-plot").fish_plot(fish_options)
      }
    })
  </script>
  <style>
    .active-sample:hover {
      background-color: #f0f0f0;
    }

    .removed-sample {
      background-color: gray;
    }
  </style>
</head>

<body>
  <main>
    <div class="container-fluid">
      <div class="row">
        <h2 class="ml-3" >Phylogic Results - Example_ND</h2>
      </div>
      <div class="card">
        <div id="headingOne" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              Clustering plot/tree
            </button>
          </h5>
        </div>
        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne">
          <div class="card-body" style="overflow-x: scroll">
            <div class="row">
              <div id="sample-name-table" style="max-height: 600px; width: 25%; padding-right: 30px; overflow-y: scroll; display: table-cell">
              </div><div class="border-right" style="overflow-x: scroll; overflow-y: hidden; width: 45%; padding-right: 30px; display: table-cell">
                <div style="min-width: 450px">
                  <div style="display: inline-block; width: 84%; vertical-align: top">
                    <div id="clustering-plot"></div>
                    <div id="treatment-plot"></div>
                    <button onclick="$('#clustering-plot').clustering_plot('download')" style="font-size: 12px">Download as SVG</button>
                  </div><div style="display: inline-block; width: 16%; vertical-align: top">
                    <div id="time-switch"></div>
                    <div id="cluster-switches" style="overflow-y: scroll; overflow-x: hidden"></div>
                  </div>
                </div>
              </div><div style="width: 30%">
                <div id="tree" style="display: table-cell; overflow: scroll"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingTwo" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
              Clonality chart
            </button>
          </h5>
        </div>
        <div id="collapseTwo" class="collapse show" aria-labelledby="headingTwo">
          <div class="card-body">
            <div class="row">
              <div id="mutation-visual" class="col-md-12 overflow-auto"></div>
              <button onclick="$('#mutation-visual').mutation_visual('download')" style="font-size: 12px">Download as SVG</button>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingThree" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
              Mutation table
            </button>
          </h5>
        </div>
        <div id="collapseThree" class="collapse show" aria-labelledby="headingThree">
          <div class="card-body">
            <div class="row">
              <div id="cluster-table" class="col-md-12 overflow-auto"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div id="headingFour" class="card-header">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
              Other plots
            </button>
          </h5>
        </div>
        <div id="collapseFour" class="collapse show" aria-labelledby="headingFour">
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 text-center">
                <div id="mutation-plot" style="overflow-x:scroll"></div>
                <button onclick="$('#mutation-plot').mutation_plot('download')" style="font-size: 12px">Download as SVG</button>
              </div>
              <div class="col-md-6 text-center" style="overflow-x:scroll">
                <div id="fish-plot"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row" style="padding-bottom: 50px"></div>
    </div>
  </main>
</body>
</html>
